{"schema_version":"1.7.3","id":"GHSA-7jxj-rpx7-ph2c","published":"2026-01-22T18:06:01Z","modified":"2026-01-22T18:18:56.877201Z","summary":"Umbraco.Forms CDN may cache sensitive form uploads when processed by ImageSharp","details":"### Impact\nProtected files uploaded through Umbraco Forms may be served to unauthenticated users when a CDN or caching layer is present and ImageSharp processes the request. ImageSharp sets aggressive cache headers by default, which can cause intermediary caches to store and serve files that should require authentication.\n\n### Patches\nThis issue affects all (supported) versions Umbraco Forms and is patched in 13.9.0, 16.4.0 and 17.1.0.\n\n### Workarounds\nAdd middleware to set cache headers for form uploads. Place the following code in your `Startup.cs` or `Program.cs` after `app.UseStaticFiles()` and any image processing middleware:\n\n```cs\napp.Use(async (context, next) =>\n{\n    var path = context.Request.Path.Value;\n\n    if (!string.IsNullOrEmpty(path) && path.StartsWith(\"/media/forms/upload/\", StringComparison.OrdinalIgnoreCase))\n    {\n        context.Response.OnStarting(() =>\n        {\n            context.Response.Headers[\"Cache-Control\"] = \"private, no-store, no-cache, must-revalidate\";\n            context.Response.Headers[\"Pragma\"] = \"no-cache\";\n            context.Response.Headers[\"Expires\"] = \"0\";\n            return Task.CompletedTask;\n        });\n    }\n\n    await next();\n});\n```\n\nAlternatively, configure your CDN to bypass caching for URLs matching `/media/forms/upload/*`.\n\n  Note: The vulnerability requires:\n  - A CDN in front of the website\n  - An authenticated user having previously requested the image\n  - Knowledge of the form GUID, entry GUID, and image filename\n\n  If no CDN is in use, this vulnerability does not apply.","affected":[{"package":{"name":"Umbraco.Forms","ecosystem":"NuGet","purl":"pkg:nuget/Umbraco.Forms"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"13.9.0"}]}],"versions":["10.0.0","10.0.0-rc1","10.0.0-rc2","10.0.0-rc3","10.0.1","10.0.2","10.0.3","10.0.4","10.0.5","10.1.0","10.1.0-rc001","10.1.1","10.1.2","10.1.3","10.2.0","10.2.0-rc001","10.2.1","10.2.2","10.2.3","10.2.4","10.3.0","10.3.0-rc001","10.3.1","10.3.2","10.3.3","10.4.0","10.4.0-rc1","10.5.0","10.5.0-rc1","10.5.1","10.5.2","10.5.3","10.5.4","10.5.5","10.5.6","10.5.7","11.0.0","11.0.0-rc1","11.0.0-rc2","11.0.0-rc3","11.0.1","11.0.2","11.0.3","11.1.0","11.1.0-rc001","11.1.1","11.1.2","11.1.3","11.2.0","11.2.0-rc1","11.2.1","12.0.0","12.0.0-rc1","12.0.0-rc2","12.0.0-rc3","12.0.0-rc4","12.0.0-rc5","12.1.0","12.1.0-rc1","12.1.1","12.1.2","12.2.0","12.2.0-rc1","12.2.1","12.2.2","12.2.3","12.2.4","13.0.0","13.0.0-rc1","13.0.0-rc2","13.0.0-rc3","13.0.0-rc4","13.0.0-rc5","13.0.1","13.0.2","13.1.0","13.1.0-rc","13.1.1","13.1.2","13.2.0","13.2.0-rc1","13.2.0-rc2","13.2.1","13.2.2","13.2.3","13.2.4","13.2.5","13.3.0","13.3.0-rc1","13.3.1","13.3.2","13.3.3","13.4.0","13.4.0-rc1","13.4.0-rc2","13.4.0-rc3","13.4.1","13.4.2","13.5.0","13.5.0-rc","13.6.0","13.7.0","13.7.0-rc","13.7.0-rc2","13.8.0","13.8.0-rc","13.8.0-rc2","13.9.0-rc","4.0.0","9.0.0","9.0.0-beta002","9.0.0-beta003","9.0.0-beta004","9.0.0-rc001","9.0.1","9.1.0","9.1.0-rc001","9.1.1","9.2.0","9.2.0-rc001","9.2.1","9.2.2","9.3.0","9.3.0-rc001","9.4.0","9.4.0-rc001","9.4.1","9.4.2","9.5.0","9.5.0-rc001","9.5.1","9.5.2","9.5.3","9.5.4","9.5.5","9.5.6","9.5.7","9.5.8","9.5.9"],"database_specific":{"source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-7jxj-rpx7-ph2c/GHSA-7jxj-rpx7-ph2c.json"}},{"package":{"name":"Umbraco.Forms","ecosystem":"NuGet","purl":"pkg:nuget/Umbraco.Forms"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"14.0.0-beta001"},{"fixed":"16.4.0"}]}],"versions":["14.0.0","14.0.0-beta001","14.0.0-beta002","14.0.0-beta003","14.0.0-beta004","14.0.0-rc1","14.0.1","14.0.2","14.1.0","14.1.0-rc1","14.1.0-rc2","14.1.1","14.1.2","14.1.3","14.1.4","14.1.5","14.2.0","14.2.0-rc1","14.2.0-rc2","14.2.1","14.2.2","14.2.3","15.0.0","15.0.0-rc1","15.0.0-rc2","15.0.0-rc3","15.0.0-rc4","15.0.1","15.0.2","15.0.3","15.1.0","15.1.0-rc1","15.1.0-rc2","15.1.0-rc3","15.1.1","15.1.2","15.2.0","15.2.0-rc","16.0.0","16.0.0-rc1","16.0.0-rc2","16.0.0-rc3","16.0.0-rc4","16.0.0-rc5","16.1.0","16.2.0","16.2.0-rc","16.2.0-rc2","16.3.0","16.3.0-rc","16.3.0-rc2","16.3.1","16.4.0-rc","16.4.0-rc2"],"database_specific":{"source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-7jxj-rpx7-ph2c/GHSA-7jxj-rpx7-ph2c.json"}},{"package":{"name":"Umbraco.Forms","ecosystem":"NuGet","purl":"pkg:nuget/Umbraco.Forms"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"17.0.0-rc1"},{"fixed":"17.1.0"}]}],"versions":["17.0.0","17.0.0-rc1","17.0.0-rc2","17.0.0-rc3","17.0.0-rc4","17.0.1","17.0.2","17.0.3","17.1.0-rc","17.1.0-rc2"],"database_specific":{"source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-7jxj-rpx7-ph2c/GHSA-7jxj-rpx7-ph2c.json"}}],"references":[{"type":"WEB","url":"https://github.com/umbraco/Umbraco.Forms.Issues/security/advisories/GHSA-7jxj-rpx7-ph2c"},{"type":"PACKAGE","url":"https://github.com/umbraco/Umbraco.Forms.Issues"}],"database_specific":{"cwe_ids":["CWE-524"],"github_reviewed":true,"github_reviewed_at":"2026-01-22T18:06:01Z","nvd_published_at":null,"severity":"LOW"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N"}]}