{"schema_version":"1.7.3","id":"DEBIAN-CVE-2024-27058","published":"2024-05-01T13:15:50Z","modified":"2025-10-14T04:01:07Z","upstream":["CVE-2024-27058"],"details":"In the Linux kernel, the following vulnerability has been resolved:  tmpfs: fix race on handling dquot rbtree  A syzkaller reproducer found a race while attempting to remove dquot information from the rb tree.  Fetching the rb_tree root node must also be protected by the dqopt->dqio_sem, otherwise, giving the right timing, shmem_release_dquot() will trigger a warning because it couldn't find a node in the tree, when the real reason was the root node changing before the search starts:  Thread 1\t\t\t\tThread 2 - shmem_release_dquot()\t\t\t- shmem_{acquire,release}_dquot()  - fetch ROOT\t\t\t\t- Fetch ROOT  \t\t\t\t\t- acquire dqio_sem - wait dqio_sem  \t\t\t\t\t- do something, triger a tree rebalance \t\t\t\t\t- release dqio_sem  - acquire dqio_sem - start searching for the node, but   from the wrong location, missing   the node, and triggering a warning.","affected":[{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.7.12-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-27058.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.7.12-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-27058.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2024-27058"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L"}]}