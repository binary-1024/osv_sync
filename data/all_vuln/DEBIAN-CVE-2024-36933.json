{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-36933.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.10.218-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "5.10.103-1",
        "5.10.103-1~bpo10+1",
        "5.10.106-1",
        "5.10.113-1",
        "5.10.120-1",
        "5.10.120-1~bpo10+1",
        "5.10.127-1",
        "5.10.127-2",
        "5.10.127-2~bpo10+1",
        "5.10.136-1",
        "5.10.140-1",
        "5.10.148-1",
        "5.10.149-1",
        "5.10.149-2",
        "5.10.158-1",
        "5.10.158-2",
        "5.10.162-1",
        "5.10.178-1",
        "5.10.178-2",
        "5.10.178-3",
        "5.10.179-1",
        "5.10.179-2",
        "5.10.179-3",
        "5.10.179-4",
        "5.10.179-5",
        "5.10.191-1",
        "5.10.197-1",
        "5.10.205-1",
        "5.10.205-2",
        "5.10.209-1",
        "5.10.209-2",
        "5.10.216-1",
        "5.10.46-4",
        "5.10.46-5",
        "5.10.70-1",
        "5.10.70-1~bpo10+1",
        "5.10.84-1",
        "5.10.92-1",
        "5.10.92-1~bpo10+1",
        "5.10.92-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-36933.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.1.94-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1",
        "6.1.90-1~bpo11+1",
        "6.1.94-1~bpo11+1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-36933.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.11-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-36933.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.11-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  nsh: Restore skb->{protocol,data,mac_header} for outer header in nsh_gso_segment().  syzbot triggered various splats (see [0] and links) by a crafted GSO packet of VIRTIO_NET_HDR_GSO_UDP layering the following protocols:    ETH_P_8021AD + ETH_P_NSH + ETH_P_IPV6 + IPPROTO_UDP  NSH can encapsulate IPv4, IPv6, Ethernet, NSH, and MPLS.  As the inner protocol can be Ethernet, NSH GSO handler, nsh_gso_segment(), calls skb_mac_gso_segment() to invoke inner protocol GSO handlers.  nsh_gso_segment() does the following for the original skb before calling skb_mac_gso_segment()    1. reset skb->network_header   2. save the original skb->{mac_heaeder,mac_len} in a local variable   3. pull the NSH header   4. resets skb->mac_header   5. set up skb->mac_len and skb->protocol for the inner protocol.  and does the following for the segmented skb    6. set ntohs(ETH_P_NSH) to skb->protocol   7. push the NSH header   8. restore skb->mac_header   9. set skb->mac_header + mac_len to skb->network_header  10. restore skb->mac_len  There are two problems in 6-7 and 8-9.    (a)   After 6 & 7, skb->data points to the NSH header, so the outer header   (ETH_P_8021AD in this case) is stripped when skb is sent out of netdev.    Also, if NSH is encapsulated by NSH + Ethernet (so NSH-Ethernet-NSH),   skb_pull() in the first nsh_gso_segment() will make skb->data point   to the middle of the outer NSH or Ethernet header because the Ethernet   header is not pulled by the second nsh_gso_segment().    (b)   While restoring skb->{mac_header,network_header} in 8 & 9,   nsh_gso_segment() does not assume that the data in the linear   buffer is shifted.    However, udp6_ufo_fragment() could shift the data and change   skb->mac_header accordingly as demonstrated by syzbot.    If this happens, even the restored skb->mac_header points to   the middle of the outer header.  It seems nsh_gso_segment() has never worked with outer headers so far.  At the end of nsh_gso_segment(), the outer header must be restored for the segmented skb, instead of the NSH header.  To do that, let's calculate the outer header position relatively from the inner header and set skb->{data,mac_header,protocol} properly.  [0]: BUG: KMSAN: uninit-value in ipvlan_process_outbound drivers/net/ipvlan/ipvlan_core.c:524 [inline] BUG: KMSAN: uninit-value in ipvlan_xmit_mode_l3 drivers/net/ipvlan/ipvlan_core.c:602 [inline] BUG: KMSAN: uninit-value in ipvlan_queue_xmit+0xf44/0x16b0 drivers/net/ipvlan/ipvlan_core.c:668  ipvlan_process_outbound drivers/net/ipvlan/ipvlan_core.c:524 [inline]  ipvlan_xmit_mode_l3 drivers/net/ipvlan/ipvlan_core.c:602 [inline]  ipvlan_queue_xmit+0xf44/0x16b0 drivers/net/ipvlan/ipvlan_core.c:668  ipvlan_start_xmit+0x5c/0x1a0 drivers/net/ipvlan/ipvlan_main.c:222  __netdev_start_xmit include/linux/netdevice.h:4989 [inline]  netdev_start_xmit include/linux/netdevice.h:5003 [inline]  xmit_one net/core/dev.c:3547 [inline]  dev_hard_start_xmit+0x244/0xa10 net/core/dev.c:3563  __dev_queue_xmit+0x33ed/0x51c0 net/core/dev.c:4351  dev_queue_xmit include/linux/netdevice.h:3171 [inline]  packet_xmit+0x9c/0x6b0 net/packet/af_packet.c:276  packet_snd net/packet/af_packet.c:3081 [inline]  packet_sendmsg+0x8aef/0x9f10 net/packet/af_packet.c:3113  sock_sendmsg_nosec net/socket.c:730 [inline]  __sock_sendmsg net/socket.c:745 [inline]  __sys_sendto+0x735/0xa10 net/socket.c:2191  __do_sys_sendto net/socket.c:2203 [inline]  __se_sys_sendto net/socket.c:2199 [inline]  __x64_sys_sendto+0x125/0x1c0 net/socket.c:2199  do_syscall_x64 arch/x86/entry/common.c:52 [inline]  do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83  entry_SYSCALL_64_after_hwframe+0x63/0x6b  Uninit was created at:  slab_post_alloc_hook mm/slub.c:3819 [inline]  slab_alloc_node mm/slub.c:3860 [inline]  __do_kmalloc_node mm/slub.c:3980 [inline]  __kmalloc_node_track_caller+0x705/0x1000 mm/slub.c:4001  kmalloc_reserve+0x249/0x4a0 net/core/skbuff.c:582  __ ---truncated---",
  "id": "DEBIAN-CVE-2024-36933",
  "modified": "2025-09-25T04:02:16.959006Z",
  "published": "2024-05-30T16:15:16Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2024-36933"
    }
  ],
  "schema_version": "1.7.3",
  "upstream": [
    "CVE-2024-36933"
  ]
}