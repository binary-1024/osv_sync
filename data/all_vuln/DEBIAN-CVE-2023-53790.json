{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-53790","published":"0001-01-01T00:00:00Z","modified":"2025-12-09T07:18:57.438691Z","upstream":["CVE-2023-53790"],"details":"In the Linux kernel, the following vulnerability has been resolved:  bpf: Zeroing allocated object from slab in bpf memory allocator  Currently the freed element in bpf memory allocator may be immediately reused, for htab map the reuse will reinitialize special fields in map value (e.g., bpf_spin_lock), but lookup procedure may still access these special fields, and it may lead to hard-lockup as shown below:   NMI backtrace for cpu 16  CPU: 16 PID: 2574 Comm: htab.bin Tainted: G             L     6.1.0+ #1  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996),  RIP: 0010:queued_spin_lock_slowpath+0x283/0x2c0  ......  Call Trace:   <TASK>   copy_map_value_locked+0xb7/0x170   bpf_map_copy_value+0x113/0x3c0   __sys_bpf+0x1c67/0x2780   __x64_sys_bpf+0x1c/0x20   do_syscall_64+0x30/0x60   entry_SYSCALL_64_after_hwframe+0x46/0xb0  ......   </TASK>  For htab map, just like the preallocated case, these is no need to initialize these special fields in map value again once these fields have been initialized. For preallocated htab map, these fields are initialized through __GFP_ZERO in bpf_map_area_alloc(), so do the similar thing for non-preallocated htab in bpf memory allocator. And there is no need to use __GFP_ZERO for per-cpu bpf memory allocator, because __alloc_percpu_gfp() does it implicitly.","affected":[{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.20-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53790.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.20-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53790.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.20-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53790.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-53790"}]}