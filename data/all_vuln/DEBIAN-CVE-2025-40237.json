{"schema_version":"1.7.3","id":"DEBIAN-CVE-2025-40237","published":"2025-12-04T16:16:16.697Z","modified":"2025-12-05T12:32:32.715151Z","upstream":["CVE-2025-40237"],"details":"In the Linux kernel, the following vulnerability has been resolved:  fs/notify: call exportfs_encode_fid with s_umount  Calling intotify_show_fdinfo() on fd watching an overlayfs inode, while the overlayfs is being unmounted, can lead to dereferencing NULL ptr.  This issue was found by syzkaller.  Race Condition Diagram:  Thread 1                           Thread 2 --------                           --------  generic_shutdown_super()  shrink_dcache_for_umount   sb->s_root = NULL                      |                     |             vfs_read()                     |              inotify_fdinfo()                     |               * inode get from mark *                     |               show_mark_fhandle(m, inode)                     |                exportfs_encode_fid(inode, ..)                     |                 ovl_encode_fh(inode, ..)                     |                  ovl_check_encode_origin(inode)                     |                   * deref i_sb->s_root *                     |                     |                     v  fsnotify_sb_delete(sb)  Which then leads to:  [   32.133461] Oops: general protection fault, probably for non-canonical address 0xdffffc0000000006: 0000 [#1] SMP DEBUG_PAGEALLOC KASAN NOPTI [   32.134438] KASAN: null-ptr-deref in range [0x0000000000000030-0x0000000000000037] [   32.135032] CPU: 1 UID: 0 PID: 4468 Comm: systemd-coredum Not tainted 6.17.0-rc6 #22 PREEMPT(none)  <snip registers, unreliable trace>  [   32.143353] Call Trace: [   32.143732]  ovl_encode_fh+0xd5/0x170 [   32.144031]  exportfs_encode_inode_fh+0x12f/0x300 [   32.144425]  show_mark_fhandle+0xbe/0x1f0 [   32.145805]  inotify_fdinfo+0x226/0x2d0 [   32.146442]  inotify_show_fdinfo+0x1c5/0x350 [   32.147168]  seq_show+0x530/0x6f0 [   32.147449]  seq_read_iter+0x503/0x12a0 [   32.148419]  seq_read+0x31f/0x410 [   32.150714]  vfs_read+0x1f0/0x9e0 [   32.152297]  ksys_read+0x125/0x240  IOW ovl_check_encode_origin derefs inode->i_sb->s_root, after it was set to NULL in the unmount path.  Fix it by protecting calling exportfs_encode_fid() from show_mark_fhandle() with s_umount lock.  This form of fix was suggested by Amir in [1].  [1]: https://lore.kernel.org/all/CAOQ4uxhbDwhb+2Brs1UdkoF0a3NSdBAOQPNfEHjahrgoKJpLEw@mail.gmail.com/","affected":[{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.12.57-1"}]}],"versions":["6.12.38-1","6.12.41-1","6.12.43-1","6.12.43-1~bpo12+1","6.12.48-1","6.12.57-1~bpo12+1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-40237.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.17.6-1"}]}],"versions":["6.12.38-1","6.12.41-1","6.12.43-1","6.12.43-1~bpo12+1","6.12.48-1","6.12.57-1","6.12.57-1~bpo12+1","6.13.10-1~exp1","6.13.11-1~exp1","6.13.2-1~exp1","6.13.3-1~exp1","6.13.4-1~exp1","6.13.5-1~exp1","6.13.6-1~exp1","6.13.7-1~exp1","6.13.8-1~exp1","6.13.9-1~exp1","6.13~rc6-1~exp1","6.13~rc7-1~exp1","6.14.3-1~exp1","6.14.5-1~exp1","6.14.6-1~exp1","6.15-1~exp1","6.15.1-1~exp1","6.15.2-1~exp1","6.15.3-1~exp1","6.15.4-1~exp1","6.15.5-1~exp1","6.15.6-1~exp1","6.15~rc7-1~exp1","6.16-1~exp1","6.16.1-1~exp1","6.16.10-1","6.16.11-1","6.16.12-1","6.16.12-1~bpo13+1","6.16.12-2","6.16.3-1","6.16.3-1~bpo13+1","6.16.5-1","6.16.6-1","6.16.7-1","6.16.8-1","6.16.9-1","6.16~rc7-1~exp1","6.17.2-1~exp1","6.17.5-1~exp1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-40237.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2025-40237"}]}