{"schema_version":"1.7.3","id":"CVE-2026-24904","published":"2026-01-29T21:19:53.261Z","modified":"2026-01-30T22:50:50.817831Z","aliases":["GHSA-fqh7-r5gf-3r87"],"summary":"TrustTunnel has `client_random_prefix` rule bypass via fragmented or partial TLS ClientHello","details":"TrustTunnel is an open-source VPN protocol with a rule bypass issue in versions prior to 0.9.115. In `tls_listener.rs`, `TlsListener::listen()` peeks 1024 bytes and calls `extract_client_random(...)`. If `parse_tls_plaintext` fails (for example, a fragmented/partial ClientHello split across TCP writes), `extract_client_random` returns `None`. In `rules.rs`, `RulesEngine::evaluate` only evaluates `client_random_prefix` when `client_random` is `Some(...)`. As a result, when extraction fails (`client_random == None`), any rule that relies on `client_random_prefix` matching is skipped and evaluation falls through to later rules. As an important semantics note: `client_random_prefix` is a match condition only. It does not mean \"block non-matching prefixes\" by itself. A rule with `client_random_prefix = ...` triggers its `action` only when the prefix matches (and the field is available to evaluate). Non-matches (or `None`) simply do not match that rule and continue to fall through. The vulnerability is fixed in version 0.9.115.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/trusttunnel/trusttunnel","events":[{"introduced":"0"},{"fixed":"4082150ccef287751dd0ec8f523aa8a28dc3ac56"}]}],"versions":["v0.9.100","v0.9.102","v0.9.105","v0.9.109","v0.9.20","v0.9.22","v0.9.23","v0.9.24","v0.9.26","v0.9.27","v0.9.38","v0.9.39","v0.9.40","v0.9.43","v0.9.47","v0.9.74","v0.9.96","v0.9.99"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2026-24904.json"}}],"references":[{"type":"ADVISORY","url":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2026/24xxx/CVE-2026-24904.json"},{"type":"FIX","url":"https://github.com/TrustTunnel/TrustTunnel/commit/aa5060145506952b9431b0ed3edb52bb6c08d9a6"},{"type":"ADVISORY","url":"https://github.com/TrustTunnel/TrustTunnel/security/advisories/GHSA-fqh7-r5gf-3r87"},{"type":"ADVISORY","url":"https://nvd.nist.gov/vuln/detail/CVE-2026-24904"}],"database_specific":{"cna_assigner":"GitHub_M","cwe_ids":["CWE-284"],"osv_generated_from":"https://github.com/CVEProject/cvelistV5/tree/main/cves/2026/24xxx/CVE-2026-24904.json"},"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"}]}