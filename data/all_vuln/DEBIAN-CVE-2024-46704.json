{"schema_version":"1.7.3","id":"DEBIAN-CVE-2024-46704","published":"2024-09-13T07:15:05Z","modified":"2025-09-30T03:54:29Z","upstream":["CVE-2024-46704"],"details":"In the Linux kernel, the following vulnerability has been resolved:  workqueue: Fix spruious data race in __flush_work()  When flushing a work item for cancellation, __flush_work() knows that it exclusively owns the work item through its PENDING bit. 134874e2eee9 (\"workqueue: Allow cancel_work_sync() and disable_work() from atomic contexts on BH work items\") added a read of @work->data to determine whether to use busy wait for BH work items that are being canceled. While the read is safe when @from_cancel, @work->data was read before testing @from_cancel to simplify code structure:  \tdata = *work_data_bits(work); \tif (from_cancel && \t    !WARN_ON_ONCE(data & WORK_STRUCT_PWQ) && (data & WORK_OFFQ_BH)) {  While the read data was never used if !@from_cancel, this could trigger KCSAN data race detection spuriously:    ==================================================================   BUG: KCSAN: data-race in __flush_work / __flush_work    write to 0xffff8881223aa3e8 of 8 bytes by task 3998 on cpu 0:    instrument_write include/linux/instrumented.h:41 [inline]    ___set_bit include/asm-generic/bitops/instrumented-non-atomic.h:28 [inline]    insert_wq_barrier kernel/workqueue.c:3790 [inline]    start_flush_work kernel/workqueue.c:4142 [inline]    __flush_work+0x30b/0x570 kernel/workqueue.c:4178    flush_work kernel/workqueue.c:4229 [inline]    ...    read to 0xffff8881223aa3e8 of 8 bytes by task 50 on cpu 1:    __flush_work+0x42a/0x570 kernel/workqueue.c:4188    flush_work kernel/workqueue.c:4229 [inline]    flush_delayed_work+0x66/0x70 kernel/workqueue.c:4251    ...    value changed: 0x0000000000400000 -> 0xffff88810006c00d  Reorganize the code so that @from_cancel is tested before @work->data is accessed. The only problem is triggering KCSAN detection spuriously. This shouldn't need READ_ONCE() or other access qualifiers.  No functional changes.","affected":[{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.10.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-46704.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.10.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-46704.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2024-46704"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}