{"schema_version":"1.7.3","id":"DEBIAN-CVE-2025-38351","published":"2025-07-19T12:15:35Z","modified":"2025-09-30T05:20:41.303484Z","upstream":["CVE-2025-38351"],"details":"In the Linux kernel, the following vulnerability has been resolved:  KVM: x86/hyper-v: Skip non-canonical addresses during PV TLB flush  In KVM guests with Hyper-V hypercalls enabled, the hypercalls HVCALL_FLUSH_VIRTUAL_ADDRESS_LIST and HVCALL_FLUSH_VIRTUAL_ADDRESS_LIST_EX allow a guest to request invalidation of portions of a virtual TLB. For this, the hypercall parameter includes a list of GVAs that are supposed to be invalidated.  However, when non-canonical GVAs are passed, there is currently no filtering in place and they are eventually passed to checked invocations of INVVPID on Intel / INVLPGA on AMD.  While AMD's INVLPGA silently ignores non-canonical addresses (effectively a no-op), Intel's INVVPID explicitly signals VM-Fail and ultimately triggers the WARN_ONCE in invvpid_error():    invvpid failed: ext=0x0 vpid=1 gva=0xaaaaaaaaaaaaa000   WARNING: CPU: 6 PID: 326 at arch/x86/kvm/vmx/vmx.c:482   invvpid_error+0x91/0xa0 [kvm_intel]   Modules linked in: kvm_intel kvm 9pnet_virtio irqbypass fuse   CPU: 6 UID: 0 PID: 326 Comm: kvm-vm Not tainted 6.15.0 #14 PREEMPT(voluntary)   RIP: 0010:invvpid_error+0x91/0xa0 [kvm_intel]   Call Trace:     vmx_flush_tlb_gva+0x320/0x490 [kvm_intel]     kvm_hv_vcpu_flush_tlb+0x24f/0x4f0 [kvm]     kvm_arch_vcpu_ioctl_run+0x3013/0x5810 [kvm]  Hyper-V documents that invalid GVAs (those that are beyond a partition's GVA space) are to be ignored.  While not completely clear whether this ruling also applies to non-canonical GVAs, it is likely fine to make that assumption, and manual testing on Azure confirms \"real\" Hyper-V interprets the specification in the same way.  Skip non-canonical GVAs when processing the list of address to avoid tripping the INVVPID failure.  Alternatively, KVM could filter out \"bad\" GVAs before inserting into the FIFO, but practically speaking the only downside of pushing validation to the final processing is that doing so is suboptimal for the guest, and no well-behaved guest will request TLB flushes for non-canonical addresses.","affected":[{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.12.41-1"}]}],"versions":["6.12.38-1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-38351.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.16.3-1"}]}],"versions":["6.12.38-1","6.12.41-1","6.12.43-1","6.12.43-1~bpo12+1","6.12.48-1","6.13.10-1~exp1","6.13.11-1~exp1","6.13.2-1~exp1","6.13.3-1~exp1","6.13.4-1~exp1","6.13.5-1~exp1","6.13.6-1~exp1","6.13.7-1~exp1","6.13.8-1~exp1","6.13.9-1~exp1","6.13~rc6-1~exp1","6.13~rc7-1~exp1","6.14.3-1~exp1","6.14.5-1~exp1","6.14.6-1~exp1","6.15-1~exp1","6.15.1-1~exp1","6.15.2-1~exp1","6.15.3-1~exp1","6.15.4-1~exp1","6.15.5-1~exp1","6.15.6-1~exp1","6.15~rc7-1~exp1","6.16-1~exp1","6.16.1-1~exp1","6.16.3-1~bpo13+1","6.16~rc7-1~exp1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-38351.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2025-38351"}]}