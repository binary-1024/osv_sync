{"schema_version":"1.7.3","id":"CVE-2025-57632","published":"2025-09-25T20:15:35.237Z","modified":"2026-01-16T06:51:19.958477Z","details":"libsmb2 6.2+ is vulnerable to Buffer Overflow. When processing SMB2 chained PDUs (NextCommand), libsmb2 repeatedly calls smb2_add_iovector() to append to a fixed-size iovec array without checking the upper bound of v->niov (SMB2_MAX_VECTORS=256). An attacker can craft responses with many chained PDUs to overflow v->niov and perform heap out-of-bounds writes, causing memory corruption, crashes, and potentially arbitrary code execution. The SMB2_OPLOCK_BREAK path bypasses message ID validation.","affected":[{"ranges":[{"type":"GIT","repo":"https://github.com/sahlberg/libsmb2","events":[{"introduced":"0"},{"fixed":"5e75eebf922b338cdb548d60cffb3b997d2a12e8"}]}],"versions":["libsmb2-1.0","libsmb2-6.0","libsmb2-6.1","libsmb2-6.2","v1.0.0","v2.0.0","v3.0.0","v4.0.0","v5.0.0","v6.0.0"],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-57632.json","vanir_signatures":[{"deprecated":false,"digest":{"line_hashes":["3604715068656525057895732284933582250","67474392744342636332293879522589848281","106544564087878161484972033647860944301"],"threshold":0.9},"id":"CVE-2025-57632-4f1be132","signature_type":"Line","signature_version":"v1","source":"https://github.com/sahlberg/libsmb2/commit/5e75eebf922b338cdb548d60cffb3b997d2a12e8","target":{"file":"lib/init.c"}},{"deprecated":false,"digest":{"function_hash":"34543669183881933262336254942550366083","length":375},"id":"CVE-2025-57632-cb3b4191","signature_type":"Function","signature_version":"v1","source":"https://github.com/sahlberg/libsmb2/commit/5e75eebf922b338cdb548d60cffb3b997d2a12e8","target":{"file":"lib/init.c","function":"smb2_add_iovector"}}]}}],"references":[{"type":"WEB","url":"https://gist.github.com/ZjW1nd/0b95b63307ceee7890e88e4abc6f041e"},{"type":"WEB","url":"https://github.com/sahlberg/libsmb2/blob/master/lib/compat.c#L569"},{"type":"FIX","url":"https://github.com/sahlberg/libsmb2/commit/5e75eebf922b338cdb548d60cffb3b997d2a12e8"},{"type":"PACKAGE","url":"https://github.com/sahlberg/libsmb2"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}]}