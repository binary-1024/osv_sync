{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-54061","published":"2025-12-24T13:16:07.890Z","modified":"2025-12-25T11:14:32.226241Z","withdrawn":"2025-12-29T19:53:22.007246Z","upstream":["CVE-2023-54061"],"details":"In the Linux kernel, the following vulnerability has been resolved:  x86: fix clear_user_rep_good() exception handling annotation  This code no longer exists in mainline, because it was removed in commit d2c95f9d6802 (\"x86: don't use REP_GOOD or ERMS for user memory clearing\") upstream.  However, rather than backport the full range of x86 memory clearing and copying cleanups, fix the exception table annotation placement for the final 'rep movsb' in clear_user_rep_good(): rather than pointing at the actual instruction that did the user space access, it pointed to the register move just before it.  That made sense from a code flow standpoint, but not from an actual usage standpoint: it means that if user access takes an exception, the exception handler won't actually find the instruction in the exception tables.  As a result, rather than fixing it up and returning -EFAULT, it would then turn it into a kernel oops report instead, something like:      BUG: unable to handle page fault for address: 0000000020081000     #PF: supervisor write access in kernel mode     #PF: error_code(0x0002) - not-present page     ...     RIP: 0010:clear_user_rep_good+0x1c/0x30 arch/x86/lib/clear_page_64.S:147     ...     Call Trace:       __clear_user arch/x86/include/asm/uaccess_64.h:103 [inline]       clear_user arch/x86/include/asm/uaccess_64.h:124 [inline]       iov_iter_zero+0x709/0x1290 lib/iov_iter.c:800       iomap_dio_hole_iter fs/iomap/direct-io.c:389 [inline]       iomap_dio_iter fs/iomap/direct-io.c:440 [inline]       __iomap_dio_rw+0xe3d/0x1cd0 fs/iomap/direct-io.c:601       iomap_dio_rw+0x40/0xa0 fs/iomap/direct-io.c:689       ext4_dio_read_iter fs/ext4/file.c:94 [inline]       ext4_file_read_iter+0x4be/0x690 fs/ext4/file.c:145       call_read_iter include/linux/fs.h:2183 [inline]       do_iter_readv_writev+0x2e0/0x3b0 fs/read_write.c:733       do_iter_read+0x2f2/0x750 fs/read_write.c:796       vfs_readv+0xe5/0x150 fs/read_write.c:916       do_preadv+0x1b6/0x270 fs/read_write.c:1008       __do_sys_preadv2 fs/read_write.c:1070 [inline]       __se_sys_preadv2 fs/read_write.c:1061 [inline]       __x64_sys_preadv2+0xef/0x150 fs/read_write.c:1061       do_syscall_x64 arch/x86/entry/common.c:50 [inline]       do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80       entry_SYSCALL_64_after_hwframe+0x63/0xcd  which then looks like a filesystem bug rather than the incorrect exception annotation that it is.  [ The alternative to this one-liner fix is to take the upstream series   that cleans this all up:      68674f94ffc9 (\"x86: don't use REP_GOOD or ERMS for small memory copies\")     20f3337d350c (\"x86: don't use REP_GOOD or ERMS for small memory clearing\")     adfcf4231b8c (\"x86: don't use REP_GOOD or ERMS for user memory copies\")   * d2c95f9d6802 (\"x86: don't use REP_GOOD or ERMS for user memory clearing\")     3639a535587d (\"x86: move stac/clac from user copy routines into callers\")     577e6a7fd50d (\"x86: inline the 'rep movs' in user copies for the FSRM case\")     8c9b6a88b7e2 (\"x86: improve on the non-rep 'clear_user' function\")     427fda2c8a49 (\"x86: improve on the non-rep 'copy_user' function\")   * e046fe5a36a9 (\"x86: set FSRS automatically on AMD CPUs that have FSRM\")     e1f2750edc4a (\"x86: remove 'zerorest' argument from __copy_user_nocache()\")     034ff37d3407 (\"x86: rewrite '__copy_user_nocache' function\")    with either the whole series or at a minimum the two marked commits   being needed to fix this issue ]","affected":[{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"}]}],"versions":["6.1.106-1","6.1.106-2","6.1.106-3","6.1.112-1","6.1.115-1","6.1.119-1","6.1.123-1","6.1.124-1","6.1.128-1","6.1.129-1","6.1.133-1","6.1.135-1","6.1.137-1","6.1.139-1","6.1.140-1","6.1.147-1","6.1.148-1","6.1.153-1","6.1.158-1","6.1.27-1","6.1.37-1","6.1.38-1","6.1.38-2","6.1.38-2~bpo11+1","6.1.38-3","6.1.38-4","6.1.38-4~bpo11+1","6.1.52-1","6.1.55-1","6.1.55-1~bpo11+1","6.1.64-1","6.1.66-1","6.1.67-1","6.1.69-1","6.1.69-1~bpo11+1","6.1.76-1","6.1.76-1~bpo11+1","6.1.82-1","6.1.85-1","6.1.90-1","6.1.90-1~bpo11+1","6.1.94-1","6.1.94-1~bpo11+1","6.1.98-1","6.1.99-1","6.10-1~exp1","6.10.1-1~exp1","6.10.11-1","6.10.11-1~bpo12+1","6.10.12-1","6.10.3-1","6.10.4-1","6.10.6-1","6.10.6-1~bpo12+1","6.10.7-1","6.10.9-1","6.11-1~exp1","6.11.10-1","6.11.10-1~bpo12+1","6.11.2-1","6.11.4-1","6.11.5-1","6.11.5-1~bpo12+1","6.11.6-1","6.11.7-1","6.11.9-1","6.11~rc4-1~exp1","6.11~rc5-1~exp1","6.12.10-1","6.12.11-1","6.12.11-1+alpha","6.12.11-1+alpha.1","6.12.12-1","6.12.12-1~bpo12+1","6.12.13-1","6.12.15-1","6.12.16-1","6.12.17-1","6.12.19-1","6.12.20-1","6.12.21-1","6.12.22-1","6.12.22-1~bpo12+1","6.12.25-1","6.12.27-1","6.12.27-1~bpo12+1","6.12.29-1","6.12.3-1","6.12.30-1","6.12.30-1~bpo12+1","6.12.31-1","6.12.32-1","6.12.32-1~bpo12+1","6.12.33-1","6.12.33-1~bpo12+1","6.12.35-1","6.12.35-1~bpo12+1","6.12.37-1","6.12.38-1","6.12.38-1~bpo12+1","6.12.41-1","6.12.43-1","6.12.43-1~bpo12+1","6.12.48-1","6.12.5-1","6.12.57-1","6.12.57-1~bpo12+1","6.12.6-1","6.12.8-1","6.12.9-1","6.12.9-1+alpha","6.12.9-1~bpo12+1","6.12~rc6-1~exp1","6.13.10-1~exp1","6.13.11-1~exp1","6.13.2-1~exp1","6.13.3-1~exp1","6.13.4-1~exp1","6.13.5-1~exp1","6.13.6-1~exp1","6.13.7-1~exp1","6.13.8-1~exp1","6.13.9-1~exp1","6.13~rc6-1~exp1","6.13~rc7-1~exp1","6.14.3-1~exp1","6.14.5-1~exp1","6.14.6-1~exp1","6.15-1~exp1","6.15.1-1~exp1","6.15.2-1~exp1","6.15.3-1~exp1","6.15.4-1~exp1","6.15.5-1~exp1","6.15.6-1~exp1","6.15~rc7-1~exp1","6.16-1~exp1","6.16.1-1~exp1","6.16.10-1","6.16.11-1","6.16.12-1","6.16.12-1~bpo13+1","6.16.12-2","6.16.3-1","6.16.3-1~bpo13+1","6.16.5-1","6.16.6-1","6.16.7-1","6.16.8-1","6.16.9-1","6.16~rc7-1~exp1","6.17.10-1","6.17.11-1","6.17.12-1","6.17.13-1","6.17.2-1~exp1","6.17.5-1~exp1","6.17.6-1","6.17.7-1","6.17.7-2","6.17.8-1","6.17.8-1~bpo13+1","6.17.9-1","6.18.1-1~exp1","6.18.2-1~exp1","6.18~rc4-1~exp1","6.18~rc4-1~exp2","6.18~rc5-1~exp1","6.18~rc6-1~exp1","6.18~rc7-1~exp1","6.3.1-1~exp1","6.3.11-1","6.3.2-1~exp1","6.3.4-1~exp1","6.3.5-1~exp1","6.3.7-1","6.3.7-1~bpo12+1","6.4.1-1~exp1","6.4.11-1","6.4.13-1","6.4.4-1","6.4.4-1~bpo12+1","6.4.4-2","6.4.4-3","6.4.4-3~bpo12+1","6.4~rc6-1~exp1","6.4~rc7-1~exp1","6.5.1-1~exp1","6.5.10-1","6.5.10-1~bpo12+1","6.5.13-1","6.5.3-1","6.5.3-1~bpo12+1","6.5.6-1","6.5.8-1","6.5~rc4-1~exp1","6.5~rc6-1~exp1","6.5~rc7-1~exp1","6.6.11-1","6.6.13-1","6.6.13-1~bpo12+1","6.6.15-1","6.6.15-2","6.6.3-1~exp1","6.6.4-1~exp1","6.6.7-1~exp1","6.6.8-1","6.6.9-1","6.7-1~exp1","6.7.1-1~exp1","6.7.12-1","6.7.12-1~bpo12+1","6.7.4-1~exp1","6.7.7-1","6.7.9-1","6.7.9-2","6.8.11-1","6.8.12-1","6.8.12-1~bpo12+1","6.8.9-1","6.9.10-1","6.9.10-1~bpo12+1","6.9.11-1","6.9.12-1","6.9.2-1~exp1","6.9.7-1","6.9.7-1~bpo12+1","6.9.8-1","6.9.9-1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54061.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.3.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54061.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.3.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54061.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-54061"}]}