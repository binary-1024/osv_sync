{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-54068","published":"2025-12-24T13:16:08.640Z","modified":"2025-12-25T11:14:27.871400Z","upstream":["CVE-2023-54068"],"details":"In the Linux kernel, the following vulnerability has been resolved:  f2fs: compress: fix to call f2fs_wait_on_page_writeback() in f2fs_write_raw_pages()  BUG_ON() will be triggered when writing files concurrently, because the same page is writtenback multiple times.  1597 void folio_end_writeback(struct folio *folio) 1598 { \t\t...... 1618     if (!__folio_end_writeback(folio)) 1619         BUG(); \t\t...... 1625 }  kernel BUG at mm/filemap.c:1619! Call Trace:  <TASK>  f2fs_write_end_io+0x1a0/0x370  blk_update_request+0x6c/0x410  blk_mq_end_request+0x15/0x130  blk_complete_reqs+0x3c/0x50  __do_softirq+0xb8/0x29b  ? sort_range+0x20/0x20  run_ksoftirqd+0x19/0x20  smpboot_thread_fn+0x10b/0x1d0  kthread+0xde/0x110  ? kthread_complete_and_exit+0x20/0x20  ret_from_fork+0x22/0x30  </TASK>  Below is the concurrency scenario:  [Process A]\t\t[Process B]\t\t[Process C] f2fs_write_raw_pages()   - redirty_page_for_writepage()   - unlock page() \t\t\tf2fs_do_write_data_page() \t\t\t  - lock_page() \t\t\t  - clear_page_dirty_for_io() \t\t\t  - set_page_writeback() [1st writeback] \t\t\t    ..... \t\t\t    - unlock page()  \t\t\t\t\t\tgeneric_perform_write() \t\t\t\t\t\t  - f2fs_write_begin() \t\t\t\t\t\t    - wait_for_stable_page()  \t\t\t\t\t\t  - f2fs_write_end() \t\t\t\t\t\t    - set_page_dirty()    - lock_page()     - f2fs_do_write_data_page()       - set_page_writeback() [2st writeback]  This problem was introduced by the previous commit 7377e853967b (\"f2fs: compress: fix potential deadlock of compress file\"). All pagelocks were released in f2fs_write_raw_pages(), but whether the page was in the writeback state was ignored in the subsequent writing process. Let's fix it by waiting for the page to writeback before writing.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.191-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.178-1","5.10.178-2","5.10.178-3","5.10.179-1","5.10.179-2","5.10.179-3","5.10.179-4","5.10.179-5","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54068.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.37-1"}]}],"versions":["6.1.27-1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54068.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.3.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54068.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.3.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54068.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-54068"}]}