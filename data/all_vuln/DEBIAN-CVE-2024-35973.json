{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-35973.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.10.216-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "5.10.103-1",
        "5.10.103-1~bpo10+1",
        "5.10.106-1",
        "5.10.113-1",
        "5.10.120-1",
        "5.10.120-1~bpo10+1",
        "5.10.127-1",
        "5.10.127-2",
        "5.10.127-2~bpo10+1",
        "5.10.136-1",
        "5.10.140-1",
        "5.10.148-1",
        "5.10.149-1",
        "5.10.149-2",
        "5.10.158-1",
        "5.10.158-2",
        "5.10.162-1",
        "5.10.178-1",
        "5.10.178-2",
        "5.10.178-3",
        "5.10.179-1",
        "5.10.179-2",
        "5.10.179-3",
        "5.10.179-4",
        "5.10.179-5",
        "5.10.191-1",
        "5.10.197-1",
        "5.10.205-1",
        "5.10.205-2",
        "5.10.209-1",
        "5.10.209-2",
        "5.10.46-4",
        "5.10.46-5",
        "5.10.70-1",
        "5.10.70-1~bpo10+1",
        "5.10.84-1",
        "5.10.92-1",
        "5.10.92-1~bpo10+1",
        "5.10.92-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-35973.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.1.90-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1~bpo11+1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-35973.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.9-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-35973.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.9-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  geneve: fix header validation in geneve[6]_xmit_skb  syzbot is able to trigger an uninit-value in geneve_xmit() [1]  Problem : While most ip tunnel helpers (like ip_tunnel_get_dsfield()) uses skb_protocol(skb, true), pskb_inet_may_pull() is only using skb->protocol.  If anything else than ETH_P_IPV6 or ETH_P_IP is found in skb->protocol, pskb_inet_may_pull() does nothing at all.  If a vlan tag was provided by the caller (af_packet in the syzbot case), the network header might not point to the correct location, and skb linear part could be smaller than expected.  Add skb_vlan_inet_prepare() to perform a complete mac validation.  Use this in geneve for the moment, I suspect we need to adopt this more broadly.  v4 - Jakub reported v3 broke l2_tos_ttl_inherit.sh selftest    - Only call __vlan_get_protocol() for vlan types.  v2,v3 - Addressed Sabrina comments on v1 and v2  [1]  BUG: KMSAN: uninit-value in geneve_xmit_skb drivers/net/geneve.c:910 [inline]  BUG: KMSAN: uninit-value in geneve_xmit+0x302d/0x5420 drivers/net/geneve.c:1030   geneve_xmit_skb drivers/net/geneve.c:910 [inline]   geneve_xmit+0x302d/0x5420 drivers/net/geneve.c:1030   __netdev_start_xmit include/linux/netdevice.h:4903 [inline]   netdev_start_xmit include/linux/netdevice.h:4917 [inline]   xmit_one net/core/dev.c:3531 [inline]   dev_hard_start_xmit+0x247/0xa20 net/core/dev.c:3547   __dev_queue_xmit+0x348d/0x52c0 net/core/dev.c:4335   dev_queue_xmit include/linux/netdevice.h:3091 [inline]   packet_xmit+0x9c/0x6c0 net/packet/af_packet.c:276   packet_snd net/packet/af_packet.c:3081 [inline]   packet_sendmsg+0x8bb0/0x9ef0 net/packet/af_packet.c:3113   sock_sendmsg_nosec net/socket.c:730 [inline]   __sock_sendmsg+0x30f/0x380 net/socket.c:745   __sys_sendto+0x685/0x830 net/socket.c:2191   __do_sys_sendto net/socket.c:2203 [inline]   __se_sys_sendto net/socket.c:2199 [inline]   __x64_sys_sendto+0x125/0x1d0 net/socket.c:2199  do_syscall_64+0xd5/0x1f0  entry_SYSCALL_64_after_hwframe+0x6d/0x75  Uninit was created at:   slab_post_alloc_hook mm/slub.c:3804 [inline]   slab_alloc_node mm/slub.c:3845 [inline]   kmem_cache_alloc_node+0x613/0xc50 mm/slub.c:3888   kmalloc_reserve+0x13d/0x4a0 net/core/skbuff.c:577   __alloc_skb+0x35b/0x7a0 net/core/skbuff.c:668   alloc_skb include/linux/skbuff.h:1318 [inline]   alloc_skb_with_frags+0xc8/0xbf0 net/core/skbuff.c:6504   sock_alloc_send_pskb+0xa81/0xbf0 net/core/sock.c:2795   packet_alloc_skb net/packet/af_packet.c:2930 [inline]   packet_snd net/packet/af_packet.c:3024 [inline]   packet_sendmsg+0x722d/0x9ef0 net/packet/af_packet.c:3113   sock_sendmsg_nosec net/socket.c:730 [inline]   __sock_sendmsg+0x30f/0x380 net/socket.c:745   __sys_sendto+0x685/0x830 net/socket.c:2191   __do_sys_sendto net/socket.c:2203 [inline]   __se_sys_sendto net/socket.c:2199 [inline]   __x64_sys_sendto+0x125/0x1d0 net/socket.c:2199  do_syscall_64+0xd5/0x1f0  entry_SYSCALL_64_after_hwframe+0x6d/0x75  CPU: 0 PID: 5033 Comm: syz-executor346 Not tainted 6.9.0-rc1-syzkaller-00005-g928a87efa423 #0 Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 02/29/2024",
  "id": "DEBIAN-CVE-2024-35973",
  "modified": "2025-09-25T04:00:55.709909Z",
  "published": "2024-05-20T10:15:12Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2024-35973"
    }
  ],
  "schema_version": "1.7.3",
  "upstream": [
    "CVE-2024-35973"
  ]
}