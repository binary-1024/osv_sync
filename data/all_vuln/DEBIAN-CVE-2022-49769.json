{"schema_version":"1.7.3","id":"DEBIAN-CVE-2022-49769","published":"2025-05-01T15:15:59Z","modified":"2025-11-07T11:19:57.893444Z","upstream":["CVE-2022-49769"],"details":"In the Linux kernel, the following vulnerability has been resolved:  gfs2: Check sb_bsize_shift after reading superblock  Fuzzers like to scribble over sb_bsize_shift but in reality it's very unlikely that this field would be corrupted on its own. Nevertheless it should be checked to avoid the possibility of messy mount errors due to bad calculations. It's always a fixed value based on the block size so we can just check that it's the expected value.  Tested with:      mkfs.gfs2 -O -p lock_nolock /dev/vdb     for i in 0 -1 64 65 32 33; do         gfs2_edit -p sb field sb_bsize_shift $i /dev/vdb         mount /dev/vdb /mnt/test && umount /mnt/test     done  Before this patch we get a withdraw after  [   76.413681] gfs2: fsid=loop0.0: fatal: invalid metadata block [   76.413681]   bh = 19 (type: exp=5, found=4) [   76.413681]   function = gfs2_meta_buffer, file = fs/gfs2/meta_io.c, line = 492  and with UBSAN configured we also get complaints like  [   76.373395] UBSAN: shift-out-of-bounds in fs/gfs2/ops_fstype.c:295:19 [   76.373815] shift exponent 4294967287 is too large for 64-bit type 'long unsigned int'  After the patch, these complaints don't appear, mount fails immediately and we get an explanation in dmesg.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.158-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49769.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.0.10-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49769.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.0.10-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49769.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.0.10-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49769.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2022-49769"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}