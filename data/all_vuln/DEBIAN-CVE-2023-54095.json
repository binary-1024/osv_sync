{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-54095","published":"2025-12-24T13:16:11.383Z","modified":"2025-12-25T11:15:16.854450Z","upstream":["CVE-2023-54095"],"details":"In the Linux kernel, the following vulnerability has been resolved:  powerpc/iommu: Fix notifiers being shared by PCI and VIO buses  fail_iommu_setup() registers the fail_iommu_bus_notifier struct to both PCI and VIO buses.  struct notifier_block is a linked list node, so this causes any notifiers later registered to either bus type to also be registered to the other since they share the same node.  This causes issues in (at least) the vgaarb code, which registers a notifier for PCI buses.  pci_notify() ends up being called on a vio device, converted with to_pci_dev() even though it's not a PCI device, and finally makes a bad access in vga_arbiter_add_pci_device() as discovered with KASAN:   BUG: KASAN: slab-out-of-bounds in vga_arbiter_add_pci_device+0x60/0xe00  Read of size 4 at addr c000000264c26fdc by task swapper/0/1   Call Trace:    dump_stack_lvl+0x1bc/0x2b8 (unreliable)    print_report+0x3f4/0xc60    kasan_report+0x244/0x698    __asan_load4+0xe8/0x250    vga_arbiter_add_pci_device+0x60/0xe00    pci_notify+0x88/0x444    notifier_call_chain+0x104/0x320    blocking_notifier_call_chain+0xa0/0x140    device_add+0xac8/0x1d30    device_register+0x58/0x80    vio_register_device_node+0x9ac/0xce0    vio_bus_scan_register_devices+0xc4/0x13c    __machine_initcall_pseries_vio_device_init+0x94/0xf0    do_one_initcall+0x12c/0xaa8    kernel_init_freeable+0xa48/0xba8    kernel_init+0x64/0x400    ret_from_kernel_thread+0x5c/0x64  Fix this by creating separate notifier_block structs for each bus type.  [mpe: Add #ifdef to fix CONFIG_IBMVIO=n build]","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.197-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.178-1","5.10.178-2","5.10.178-3","5.10.179-1","5.10.179-2","5.10.179-3","5.10.179-4","5.10.179-5","5.10.191-1","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54095.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.55-1"}]}],"versions":["6.1.27-1","6.1.37-1","6.1.38-1","6.1.38-2","6.1.38-2~bpo11+1","6.1.38-3","6.1.38-4","6.1.38-4~bpo11+1","6.1.52-1","6.1.55-1~bpo11+1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54095.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.5.3-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54095.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.5.3-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54095.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-54095"}]}