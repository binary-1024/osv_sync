{
  "affected": [
    {
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/05/GHSA-pjx8-984p-7p3x/GHSA-pjx8-984p-7p3x.json"
      },
      "package": {
        "ecosystem": "Packagist",
        "name": "friendsofsymfony/user-bundle",
        "purl": "pkg:composer/friendsofsymfony/user-bundle"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "1.0.0"
            },
            {
              "fixed": "1.3.5"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "1.1.0",
        "1.2.0",
        "v1.2.1",
        "v1.2.2",
        "v1.2.3",
        "v1.2.4",
        "v1.2.5",
        "v1.3.0",
        "v1.3.1",
        "v1.3.2",
        "v1.3.3",
        "v1.3.4"
      ]
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-331"
    ],
    "github_reviewed": true,
    "github_reviewed_at": "2024-05-15T21:42:25Z",
    "nvd_published_at": null,
    "severity": "MODERATE"
  },
  "details": "### Description\nBecause of the usage of base_convert which looses precision for large inputs, the entropy of tokens generated by FOSUserBundle for the email confirmation and password resetting is lost. This makes these tokens much less random than they are expected to be, and so not cryptographically safe.\n\n### Resolution\nThe token generation logic used in the 2.0.x branch based on base64 encoding has been backported. This changes the range of characters used in the token. Any route placeholder expected to match a token generated by FOSUserBundle must be updated to allow dashes, which are not allowed by \\w in regexes. A \\w+ requirement should so become [\\w\\-]+.",
  "id": "GHSA-pjx8-984p-7p3x",
  "modified": "2024-11-29T05:41:12.279694Z",
  "published": "2024-05-15T21:42:25Z",
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/FriendsOfSymfony/FOSUserBundle/commit/b3ebfea52065e9727508f5f8e6c9f7459a1b06d8"
    },
    {
      "type": "WEB",
      "url": "https://github.com/FriendsOfPHP/security-advisories/blob/master/friendsofsymfony/user-bundle/2014-09-04-1.yaml"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/FriendsOfSymfony/FOSUserBundle"
    },
    {
      "type": "WEB",
      "url": "https://symfony.com/blog/fosuserbundle-entropy-of-generated-tokens-is-lost"
    }
  ],
  "schema_version": "1.6.0",
  "summary": "FOSUserBundle Entropy is lost in the TokenGenerator"
}