{"schema_version":"1.7.3","id":"DEBIAN-CVE-2021-47375","published":"2024-05-21T15:15:23Z","modified":"2025-10-14T04:25:28.988418Z","upstream":["CVE-2021-47375"],"details":"In the Linux kernel, the following vulnerability has been resolved:  blktrace: Fix uaf in blk_trace access after removing by sysfs  There is an use-after-free problem triggered by following process:        P1(sda)\t\t\t\tP2(sdb) \t\t\techo 0 > /sys/block/sdb/trace/enable \t\t\t  blk_trace_remove_queue \t\t\t    synchronize_rcu \t\t\t    blk_trace_free \t\t\t      relay_close rcu_read_lock __blk_add_trace   trace_note_tsk   (Iterate running_trace_list) \t\t\t        relay_close_buf \t\t\t\t  relay_destroy_buf \t\t\t\t    kfree(buf)     trace_note(sdb's bt)       relay_reserve         buf->offset <- nullptr deference (use-after-free) !!! rcu_read_unlock  [  502.714379] BUG: kernel NULL pointer dereference, address: 0000000000000010 [  502.715260] #PF: supervisor read access in kernel mode [  502.715903] #PF: error_code(0x0000) - not-present page [  502.716546] PGD 103984067 P4D 103984067 PUD 17592b067 PMD 0 [  502.717252] Oops: 0000 [#1] SMP [  502.720308] RIP: 0010:trace_note.isra.0+0x86/0x360 [  502.732872] Call Trace: [  502.733193]  __blk_add_trace.cold+0x137/0x1a3 [  502.733734]  blk_add_trace_rq+0x7b/0xd0 [  502.734207]  blk_add_trace_rq_issue+0x54/0xa0 [  502.734755]  blk_mq_start_request+0xde/0x1b0 [  502.735287]  scsi_queue_rq+0x528/0x1140 ... [  502.742704]  sg_new_write.isra.0+0x16e/0x3e0 [  502.747501]  sg_ioctl+0x466/0x1100  Reproduce method:   ioctl(/dev/sda, BLKTRACESETUP, blk_user_trace_setup[buf_size=127])   ioctl(/dev/sda, BLKTRACESTART)   ioctl(/dev/sdb, BLKTRACESETUP, blk_user_trace_setup[buf_size=127])   ioctl(/dev/sdb, BLKTRACESTART)    echo 0 > /sys/block/sdb/trace/enable &   // Add delay(mdelay/msleep) before kernel enters blk_trace_free()    ioctl$SG_IO(/dev/sda, SG_IO, ...)   // Enters trace_note_tsk() after blk_trace_free() returned   // Use mdelay in rcu region rather than msleep(which may schedule out)  Remove blk_trace from running_list before calling blk_trace_free() by sysfs if blk_trace is at Blktrace_running state.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.70-1"}]}],"versions":["5.10.46-4","5.10.46-5","5.10.70-1~bpo10+1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47375.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.14.9-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47375.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.14.9-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47375.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.14.9-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47375.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2021-47375"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"}]}