{"schema_version":"1.7.3","id":"DEBIAN-CVE-2022-50755","published":"2025-12-24T13:16:02.250Z","modified":"2025-12-25T11:12:13.698086Z","upstream":["CVE-2022-50755"],"details":"In the Linux kernel, the following vulnerability has been resolved:  udf: Avoid double brelse() in udf_rename()  syzbot reported a warning like below [1]:  VFS: brelse: Trying to free free buffer WARNING: CPU: 2 PID: 7301 at fs/buffer.c:1145 __brelse+0x67/0xa0 ... Call Trace:  <TASK>  invalidate_bh_lru+0x99/0x150  smp_call_function_many_cond+0xe2a/0x10c0  ? generic_remap_file_range_prep+0x50/0x50  ? __brelse+0xa0/0xa0  ? __mutex_lock+0x21c/0x12d0  ? smp_call_on_cpu+0x250/0x250  ? rcu_read_lock_sched_held+0xb/0x60  ? lock_release+0x587/0x810  ? __brelse+0xa0/0xa0  ? generic_remap_file_range_prep+0x50/0x50  on_each_cpu_cond_mask+0x3c/0x80  blkdev_flush_mapping+0x13a/0x2f0  blkdev_put_whole+0xd3/0xf0  blkdev_put+0x222/0x760  deactivate_locked_super+0x96/0x160  deactivate_super+0xda/0x100  cleanup_mnt+0x222/0x3d0  task_work_run+0x149/0x240  ? task_work_cancel+0x30/0x30  do_exit+0xb29/0x2a40  ? reacquire_held_locks+0x4a0/0x4a0  ? do_raw_spin_lock+0x12a/0x2b0  ? mm_update_next_owner+0x7c0/0x7c0  ? rwlock_bug.part.0+0x90/0x90  ? zap_other_threads+0x234/0x2d0  do_group_exit+0xd0/0x2a0  __x64_sys_exit_group+0x3a/0x50  do_syscall_64+0x34/0xb0  entry_SYSCALL_64_after_hwframe+0x63/0xcd  The cause of the issue is that brelse() is called on both ofibh.sbh and ofibh.ebh by udf_find_entry() when it returns NULL.  However, brelse() is called by udf_rename(), too.  So, b_count on buffer_head becomes unbalanced.  This patch fixes the issue by not calling brelse() by udf_rename() when udf_find_entry() returns NULL.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.178-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50755.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50755.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50755.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50755.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2022-50755"}]}