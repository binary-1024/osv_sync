{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-54247","published":"2025-12-30T13:16:13.327Z","modified":"2026-01-05T18:19:33.480590Z","upstream":["CVE-2023-54247"],"details":"In the Linux kernel, the following vulnerability has been resolved:  bpf: Silence a warning in btf_type_id_size()  syzbot reported a warning in [1] with the following stacktrace:   WARNING: CPU: 0 PID: 5005 at kernel/bpf/btf.c:1988 btf_type_id_size+0x2d9/0x9d0 kernel/bpf/btf.c:1988   ...   RIP: 0010:btf_type_id_size+0x2d9/0x9d0 kernel/bpf/btf.c:1988   ...   Call Trace:    <TASK>    map_check_btf kernel/bpf/syscall.c:1024 [inline]    map_create+0x1157/0x1860 kernel/bpf/syscall.c:1198    __sys_bpf+0x127f/0x5420 kernel/bpf/syscall.c:5040    __do_sys_bpf kernel/bpf/syscall.c:5162 [inline]    __se_sys_bpf kernel/bpf/syscall.c:5160 [inline]    __x64_sys_bpf+0x79/0xc0 kernel/bpf/syscall.c:5160    do_syscall_x64 arch/x86/entry/common.c:50 [inline]    do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80    entry_SYSCALL_64_after_hwframe+0x63/0xcd  With the following btf   [1] DECL_TAG 'a' type_id=4 component_idx=-1   [2] PTR '(anon)' type_id=0   [3] TYPE_TAG 'a' type_id=2   [4] VAR 'a' type_id=3, linkage=static and when the bpf_attr.btf_key_type_id = 1 (DECL_TAG), the following WARN_ON_ONCE in btf_type_id_size() is triggered:   if (WARN_ON_ONCE(!btf_type_is_modifier(size_type) &&                    !btf_type_is_var(size_type)))           return NULL;  Note that 'return NULL' is the correct behavior as we don't want a DECL_TAG type to be used as a btf_{key,value}_type_id even for the case like 'DECL_TAG -> STRUCT'. So there is no correctness issue here, we just want to silence warning.  To silence the warning, I added DECL_TAG as one of kinds in btf_type_nosize() which will cause btf_type_id_size() returning NULL earlier without the warning.    [1] https://lore.kernel.org/bpf/000000000000e0df8d05fc75ba86@google.com/","affected":[{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.112-1"}]}],"versions":["6.1.106-1","6.1.106-2","6.1.106-3","6.1.27-1","6.1.37-1","6.1.38-1","6.1.38-2","6.1.38-2~bpo11+1","6.1.38-3","6.1.38-4","6.1.38-4~bpo11+1","6.1.52-1","6.1.55-1","6.1.55-1~bpo11+1","6.1.64-1","6.1.66-1","6.1.67-1","6.1.69-1","6.1.69-1~bpo11+1","6.1.76-1","6.1.76-1~bpo11+1","6.1.82-1","6.1.85-1","6.1.90-1","6.1.90-1~bpo11+1","6.1.94-1","6.1.94-1~bpo11+1","6.1.98-1","6.1.99-1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54247.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.4.11-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54247.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.4.11-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54247.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-54247"}]}