{"schema_version":"1.7.3","id":"DEBIAN-CVE-2021-46982","published":"2024-02-28T09:15:37Z","modified":"2025-09-30T03:54:18Z","upstream":["CVE-2021-46982"],"details":"In the Linux kernel, the following vulnerability has been resolved:  f2fs: compress: fix race condition of overwrite vs truncate  pos_fsstress testcase complains a panic as belew:  ------------[ cut here ]------------ kernel BUG at fs/f2fs/compress.c:1082! invalid opcode: 0000 [#1] SMP PTI CPU: 4 PID: 2753477 Comm: kworker/u16:2 Tainted: G           OE     5.12.0-rc1-custom #1 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-2 04/01/2014 Workqueue: writeback wb_workfn (flush-252:16) RIP: 0010:prepare_compress_overwrite+0x4c0/0x760 [f2fs] Call Trace:  f2fs_prepare_compress_overwrite+0x5f/0x80 [f2fs]  f2fs_write_cache_pages+0x468/0x8a0 [f2fs]  f2fs_write_data_pages+0x2a4/0x2f0 [f2fs]  do_writepages+0x38/0xc0  __writeback_single_inode+0x44/0x2a0  writeback_sb_inodes+0x223/0x4d0  __writeback_inodes_wb+0x56/0xf0  wb_writeback+0x1dd/0x290  wb_workfn+0x309/0x500  process_one_work+0x220/0x3c0  worker_thread+0x53/0x420  kthread+0x12f/0x150  ret_from_fork+0x22/0x30  The root cause is truncate() may race with overwrite as below, so that one reference count left in page can not guarantee the page attaching in mapping tree all the time, after truncation, later find_lock_page() may return NULL pointer.  - prepare_compress_overwrite  - f2fs_pagecache_get_page  - unlock_page \t\t\t\t\t- f2fs_setattr \t\t\t\t\t - truncate_setsize \t\t\t\t\t  - truncate_inode_page \t\t\t\t\t   - delete_from_page_cache  - find_lock_page  Fix this by avoiding referencing updated page.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.38-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-46982.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.38-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-46982.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.38-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-46982.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.38-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-46982.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2021-46982"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}