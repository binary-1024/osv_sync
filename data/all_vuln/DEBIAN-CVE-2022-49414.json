{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49414.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.10.136-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "5.10.103-1",
        "5.10.103-1~bpo10+1",
        "5.10.106-1",
        "5.10.113-1",
        "5.10.120-1",
        "5.10.120-1~bpo10+1",
        "5.10.127-1",
        "5.10.127-2",
        "5.10.127-2~bpo10+1",
        "5.10.46-4",
        "5.10.46-5",
        "5.10.70-1",
        "5.10.70-1~bpo10+1",
        "5.10.84-1",
        "5.10.92-1",
        "5.10.92-1~bpo10+1",
        "5.10.92-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49414.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.18.5-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49414.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.18.5-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49414.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.18.5-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  ext4: fix race condition between ext4_write and ext4_convert_inline_data  Hulk Robot reported a BUG_ON:  ==================================================================  EXT4-fs error (device loop3): ext4_mb_generate_buddy:805: group 0,  block bitmap and bg descriptor inconsistent: 25 vs 31513 free clusters  kernel BUG at fs/ext4/ext4_jbd2.c:53!  invalid opcode: 0000 [#1] SMP KASAN PTI  CPU: 0 PID: 25371 Comm: syz-executor.3 Not tainted 5.10.0+ #1  RIP: 0010:ext4_put_nojournal fs/ext4/ext4_jbd2.c:53 [inline]  RIP: 0010:__ext4_journal_stop+0x10e/0x110 fs/ext4/ext4_jbd2.c:116  [...]  Call Trace:   ext4_write_inline_data_end+0x59a/0x730 fs/ext4/inline.c:795   generic_perform_write+0x279/0x3c0 mm/filemap.c:3344   ext4_buffered_write_iter+0x2e3/0x3d0 fs/ext4/file.c:270   ext4_file_write_iter+0x30a/0x11c0 fs/ext4/file.c:520   do_iter_readv_writev+0x339/0x3c0 fs/read_write.c:732   do_iter_write+0x107/0x430 fs/read_write.c:861   vfs_writev fs/read_write.c:934 [inline]   do_pwritev+0x1e5/0x380 fs/read_write.c:1031  [...]  ==================================================================  Above issue may happen as follows:            cpu1                     cpu2 __________________________|__________________________ do_pwritev  vfs_writev   do_iter_write    ext4_file_write_iter     ext4_buffered_write_iter      generic_perform_write       ext4_da_write_begin                            vfs_fallocate                             ext4_fallocate                              ext4_convert_inline_data                               ext4_convert_inline_data_nolock                                ext4_destroy_inline_data_nolock                                 clear EXT4_STATE_MAY_INLINE_DATA                                ext4_map_blocks                                 ext4_ext_map_blocks                                  ext4_mb_new_blocks                                   ext4_mb_regular_allocator                                    ext4_mb_good_group_nolock                                     ext4_mb_init_group                                      ext4_mb_init_cache                                       ext4_mb_generate_buddy  --> error        ext4_test_inode_state(inode, EXT4_STATE_MAY_INLINE_DATA)                                 ext4_restore_inline_data                                  set EXT4_STATE_MAY_INLINE_DATA        ext4_block_write_begin       ext4_da_write_end        ext4_test_inode_state(inode, EXT4_STATE_MAY_INLINE_DATA)        ext4_write_inline_data_end         handle=NULL         ext4_journal_stop(handle)          __ext4_journal_stop           ext4_put_nojournal(handle)            ref_cnt = (unsigned long)handle            BUG_ON(ref_cnt == 0)  ---> BUG_ON  The lock held by ext4_convert_inline_data is xattr_sem, but the lock held by generic_perform_write is i_rwsem. Therefore, the two locks can be concurrent.  To solve above issue, we add inode_lock() for ext4_convert_inline_data(). At the same time, move ext4_convert_inline_data() in front of ext4_punch_hole(), remove similar handling from ext4_punch_hole().",
  "id": "DEBIAN-CVE-2022-49414",
  "modified": "2025-09-25T03:16:47.418241Z",
  "published": "2025-02-26T07:01:17Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2022-49414"
    }
  ],
  "schema_version": "1.7.3",
  "upstream": [
    "CVE-2022-49414"
  ]
}