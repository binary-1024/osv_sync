{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49063.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.10.244-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "5.10.103-1",
        "5.10.103-1~bpo10+1",
        "5.10.106-1",
        "5.10.113-1",
        "5.10.120-1",
        "5.10.120-1~bpo10+1",
        "5.10.127-1",
        "5.10.127-2",
        "5.10.127-2~bpo10+1",
        "5.10.136-1",
        "5.10.140-1",
        "5.10.148-1",
        "5.10.149-1",
        "5.10.149-2",
        "5.10.158-1",
        "5.10.158-2",
        "5.10.162-1",
        "5.10.178-1",
        "5.10.178-2",
        "5.10.178-3",
        "5.10.179-1",
        "5.10.179-2",
        "5.10.179-3",
        "5.10.179-4",
        "5.10.179-5",
        "5.10.191-1",
        "5.10.197-1",
        "5.10.205-1",
        "5.10.205-2",
        "5.10.209-1",
        "5.10.209-2",
        "5.10.216-1",
        "5.10.218-1",
        "5.10.221-1",
        "5.10.223-1",
        "5.10.226-1",
        "5.10.234-1",
        "5.10.237-1",
        "5.10.46-4",
        "5.10.46-5",
        "5.10.70-1",
        "5.10.70-1~bpo10+1",
        "5.10.84-1",
        "5.10.92-1",
        "5.10.92-1~bpo10+1",
        "5.10.92-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49063.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.17.6-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49063.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.17.6-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49063.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.17.6-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  ice: arfs: fix use-after-free when freeing @rx_cpu_rmap  The CI testing bots triggered the following splat:  [  718.203054] BUG: KASAN: use-after-free in free_irq_cpu_rmap+0x53/0x80 [  718.206349] Read of size 4 at addr ffff8881bd127e00 by task sh/20834 [  718.212852] CPU: 28 PID: 20834 Comm: sh Kdump: loaded Tainted: G S      W IOE     5.17.0-rc8_nextqueue-devqueue-02643-g23f3121aca93 #1 [  718.219695] Hardware name: Intel Corporation S2600WFT/S2600WFT, BIOS SE5C620.86B.02.01.0012.070720200218 07/07/2020 [  718.223418] Call Trace: [  718.227139] [  718.230783]  dump_stack_lvl+0x33/0x42 [  718.234431]  print_address_description.constprop.9+0x21/0x170 [  718.238177]  ? free_irq_cpu_rmap+0x53/0x80 [  718.241885]  ? free_irq_cpu_rmap+0x53/0x80 [  718.245539]  kasan_report.cold.18+0x7f/0x11b [  718.249197]  ? free_irq_cpu_rmap+0x53/0x80 [  718.252852]  free_irq_cpu_rmap+0x53/0x80 [  718.256471]  ice_free_cpu_rx_rmap.part.11+0x37/0x50 [ice] [  718.260174]  ice_remove_arfs+0x5f/0x70 [ice] [  718.263810]  ice_rebuild_arfs+0x3b/0x70 [ice] [  718.267419]  ice_rebuild+0x39c/0xb60 [ice] [  718.270974]  ? asm_sysvec_apic_timer_interrupt+0x12/0x20 [  718.274472]  ? ice_init_phy_user_cfg+0x360/0x360 [ice] [  718.278033]  ? delay_tsc+0x4a/0xb0 [  718.281513]  ? preempt_count_sub+0x14/0xc0 [  718.284984]  ? delay_tsc+0x8f/0xb0 [  718.288463]  ice_do_reset+0x92/0xf0 [ice] [  718.292014]  ice_pci_err_resume+0x91/0xf0 [ice] [  718.295561]  pci_reset_function+0x53/0x80 <...> [  718.393035] Allocated by task 690: [  718.433497] Freed by task 20834: [  718.495688] Last potentially related work creation: [  718.568966] The buggy address belongs to the object at ffff8881bd127e00                 which belongs to the cache kmalloc-96 of size 96 [  718.574085] The buggy address is located 0 bytes inside of                 96-byte region [ffff8881bd127e00, ffff8881bd127e60) [  718.579265] The buggy address belongs to the page: [  718.598905] Memory state around the buggy address: [  718.601809]  ffff8881bd127d00: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc [  718.604796]  ffff8881bd127d80: 00 00 00 00 00 00 00 00 00 00 fc fc fc fc fc fc [  718.607794] >ffff8881bd127e00: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc [  718.610811]                    ^ [  718.613819]  ffff8881bd127e80: 00 00 00 00 00 00 00 00 00 00 00 00 fc fc fc fc [  718.617107]  ffff8881bd127f00: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc  This is due to that free_irq_cpu_rmap() is always being called *after* (devm_)free_irq() and thus it tries to work with IRQ descs already freed. For example, on device reset the driver frees the rmap right before allocating a new one (the splat above). Make rmap creation and freeing function symmetrical with {request,free}_irq() calls i.e. do that on ifup/ifdown instead of device probe/remove/resume. These operations can be performed independently from the actual device aRFS configuration. Also, make sure ice_vsi_free_irq() clears IRQ affinity notifiers only when aRFS is disabled -- otherwise, CPU rmap sets and clears its own and they must not be touched manually.",
  "id": "DEBIAN-CVE-2022-49063",
  "modified": "2025-10-13T11:18:28.508344Z",
  "published": "2025-02-26T07:00:43Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2022-49063"
    }
  ],
  "schema_version": "1.7.3",
  "upstream": [
    "CVE-2022-49063"
  ]
}