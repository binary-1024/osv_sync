{"schema_version":"1.7.3","id":"CVE-2025-40183","published":"2025-11-12T21:56:27.429Z","modified":"2025-12-01T19:33:57.308641Z","summary":"bpf: Fix metadata_dst leak __bpf_redirect_neigh_v{4,6}","details":"In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix metadata_dst leak __bpf_redirect_neigh_v{4,6}\n\nCilium has a BPF egress gateway feature which forces outgoing K8s Pod\ntraffic to pass through dedicated egress gateways which then SNAT the\ntraffic in order to interact with stable IPs outside the cluster.\n\nThe traffic is directed to the gateway via vxlan tunnel in collect md\nmode. A recent BPF change utilized the bpf_redirect_neigh() helper to\nforward packets after the arrival and decap on vxlan, which turned out\nover time that the kmalloc-256 slab usage in kernel was ever-increasing.\n\nThe issue was that vxlan allocates the metadata_dst object and attaches\nit through a fake dst entry to the skb. The latter was never released\nthough given bpf_redirect_neigh() was merely setting the new dst entry\nvia skb_dst_set() without dropping an existing one first.","affected":[{"ranges":[{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"3fba965a9aac0fa3cbd8138436a37af9ab466d79"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"057764172fcc6ee2ccb6c41351a55a9f054dc8fd"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"2e67c2037382abb56497bb9d7b7e10be04eb5598"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"b6bfe44b6dbb14a31d86c475cdc9c7689534fb09"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"f36a305d30f557306d87c787ddffe094ac5dac89"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"7404ce888a45eb7da0508b7cbbe6f2e95302eeb8"}]},{"type":"GIT","repo":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git","events":[{"introduced":"b4ab31414970a7a03a5d55d75083f2c101a30592"},{"fixed":"23f3770e1a53e6c7a553135011f547209e141e72"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40183.json"}},{"package":{"name":"Kernel","ecosystem":"Linux"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"5.10.0"},{"fixed":"5.10.246"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.11.0"},{"fixed":"5.15.195"}]},{"type":"ECOSYSTEM","events":[{"introduced":"5.16.0"},{"fixed":"6.1.157"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.2.0"},{"fixed":"6.6.113"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.7.0"},{"fixed":"6.12.54"}]},{"type":"ECOSYSTEM","events":[{"introduced":"6.13.0"},{"fixed":"6.17.4"}]}],"database_specific":{"source":"https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-40183.json"}}],"references":[{"type":"PACKAGE","url":"https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git"},{"type":"WEB","url":"https://git.kernel.org/stable/c/057764172fcc6ee2ccb6c41351a55a9f054dc8fd"},{"type":"WEB","url":"https://git.kernel.org/stable/c/23f3770e1a53e6c7a553135011f547209e141e72"},{"type":"WEB","url":"https://git.kernel.org/stable/c/2e67c2037382abb56497bb9d7b7e10be04eb5598"},{"type":"WEB","url":"https://git.kernel.org/stable/c/3fba965a9aac0fa3cbd8138436a37af9ab466d79"},{"type":"WEB","url":"https://git.kernel.org/stable/c/7404ce888a45eb7da0508b7cbbe6f2e95302eeb8"},{"type":"WEB","url":"https://git.kernel.org/stable/c/b6bfe44b6dbb14a31d86c475cdc9c7689534fb09"},{"type":"WEB","url":"https://git.kernel.org/stable/c/f36a305d30f557306d87c787ddffe094ac5dac89"}]}