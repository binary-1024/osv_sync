{"schema_version":"1.7.3","id":"DEBIAN-CVE-2022-50770","published":"2025-12-24T13:16:03.813Z","modified":"2025-12-25T11:12:42.819818Z","upstream":["CVE-2022-50770"],"details":"In the Linux kernel, the following vulnerability has been resolved:  ocfs2: fix memory leak in ocfs2_mount_volume()  There is a memory leak reported by kmemleak:    unreferenced object 0xffff88810cc65e60 (size 32):     comm \"mount.ocfs2\", pid 23753, jiffies 4302528942 (age 34735.105s)     hex dump (first 32 bytes):       10 00 00 00 00 00 00 00 00 01 01 01 01 01 01 01  ................       01 01 01 01 01 01 01 01 00 00 00 00 00 00 00 00  ................     backtrace:       [<ffffffff8170f73d>] __kmalloc+0x4d/0x150       [<ffffffffa0ac3f51>] ocfs2_compute_replay_slots+0x121/0x330 [ocfs2]       [<ffffffffa0b65165>] ocfs2_check_volume+0x485/0x900 [ocfs2]       [<ffffffffa0b68129>] ocfs2_mount_volume.isra.0+0x1e9/0x650 [ocfs2]       [<ffffffffa0b7160b>] ocfs2_fill_super+0xe0b/0x1740 [ocfs2]       [<ffffffff818e1fe2>] mount_bdev+0x312/0x400       [<ffffffff819a086d>] legacy_get_tree+0xed/0x1d0       [<ffffffff818de82d>] vfs_get_tree+0x7d/0x230       [<ffffffff81957f92>] path_mount+0xd62/0x1760       [<ffffffff81958a5a>] do_mount+0xca/0xe0       [<ffffffff81958d3c>] __x64_sys_mount+0x12c/0x1a0       [<ffffffff82f26f15>] do_syscall_64+0x35/0x80       [<ffffffff8300006a>] entry_SYSCALL_64_after_hwframe+0x46/0xb0  This call stack is related to two problems.  Firstly, the ocfs2 super uses \"replay_map\" to trace online/offline slots, in order to recover offline slots during recovery and mount.  But when ocfs2_truncate_log_init() returns an error in ocfs2_mount_volume(), the memory of \"replay_map\" will not be freed in error handling path.  Secondly, the memory of \"replay_map\" will not be freed if d_make_root() returns an error in ocfs2_fill_super(). But the memory of \"replay_map\" will be freed normally when completing recovery and mount in ocfs2_complete_mount_recovery().  Fix the first problem by adding error handling path to free \"replay_map\" when ocfs2_truncate_log_init() fails.  And fix the second problem by calling ocfs2_free_replay_slots(osb) in the error handling path \"out_dismount\".  In addition, since ocfs2_free_replay_slots() is static, it is necessary to remove its static attribute and declare it in header file.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.178-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50770.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50770.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50770.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50770.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2022-50770"}]}