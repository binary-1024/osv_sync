{"schema_version":"1.7.3","id":"DEBIAN-CVE-2022-49884","published":"2025-05-01T15:16:13Z","modified":"2025-09-25T03:20:36.428528Z","upstream":["CVE-2022-49884"],"details":"In the Linux kernel, the following vulnerability has been resolved:  KVM: Initialize gfn_to_pfn_cache locks in dedicated helper  Move the gfn_to_pfn_cache lock initialization to another helper and call the new helper during VM/vCPU creation.  There are race conditions possible due to kvm_gfn_to_pfn_cache_init()'s ability to re-initialize the cache's locks.  For example: a race between ioctl(KVM_XEN_HVM_EVTCHN_SEND) and kvm_gfn_to_pfn_cache_init() leads to a corrupted shinfo gpc lock.                  (thread 1)                |           (thread 2)                                           |  kvm_xen_set_evtchn_fast                  |   read_lock_irqsave(&gpc->lock, ...)      |                                           | kvm_gfn_to_pfn_cache_init                                           |  rwlock_init(&gpc->lock)   read_unlock_irqrestore(&gpc->lock, ...) |  Rename \"cache_init\" and \"cache_destroy\" to activate+deactivate to avoid implying that the cache really is destroyed/freed.  Note, there more races in the newly named kvm_gpc_activate() that will be addressed separately.  [sean: call out that this is a bug fix]","affected":[{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.0.8-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49884.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.0.8-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49884.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.0.8-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49884.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2022-49884"}]}