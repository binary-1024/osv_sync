{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-38622.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.1.148-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.1.106-1",
        "6.1.106-2",
        "6.1.106-3",
        "6.1.112-1",
        "6.1.115-1",
        "6.1.119-1",
        "6.1.123-1",
        "6.1.124-1",
        "6.1.128-1",
        "6.1.129-1",
        "6.1.133-1",
        "6.1.135-1",
        "6.1.137-1",
        "6.1.139-1",
        "6.1.140-1",
        "6.1.147-1",
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1",
        "6.1.90-1~bpo11+1",
        "6.1.94-1",
        "6.1.94-1~bpo11+1",
        "6.1.98-1",
        "6.1.99-1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-38622.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.12.43-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.12.38-1",
        "6.12.41-1",
        "6.12.43-1~bpo12+1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-38622.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.16.3-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.12.38-1",
        "6.12.41-1",
        "6.12.43-1",
        "6.12.43-1~bpo12+1",
        "6.12.48-1",
        "6.13.10-1~exp1",
        "6.13.11-1~exp1",
        "6.13.2-1~exp1",
        "6.13.3-1~exp1",
        "6.13.4-1~exp1",
        "6.13.5-1~exp1",
        "6.13.6-1~exp1",
        "6.13.7-1~exp1",
        "6.13.8-1~exp1",
        "6.13.9-1~exp1",
        "6.13~rc6-1~exp1",
        "6.13~rc7-1~exp1",
        "6.14.3-1~exp1",
        "6.14.5-1~exp1",
        "6.14.6-1~exp1",
        "6.15-1~exp1",
        "6.15.1-1~exp1",
        "6.15.2-1~exp1",
        "6.15.3-1~exp1",
        "6.15.4-1~exp1",
        "6.15.5-1~exp1",
        "6.15.6-1~exp1",
        "6.15~rc7-1~exp1",
        "6.16-1~exp1",
        "6.16.1-1~exp1",
        "6.16.3-1~bpo13+1",
        "6.16~rc7-1~exp1"
      ]
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  net: drop UFO packets in udp_rcv_segment()  When sending a packet with virtio_net_hdr to tun device, if the gso_type in virtio_net_hdr is SKB_GSO_UDP and the gso_size is less than udphdr size, below crash may happen.    ------------[ cut here ]------------   kernel BUG at net/core/skbuff.c:4572!   Oops: invalid opcode: 0000 [#1] SMP NOPTI   CPU: 0 UID: 0 PID: 62 Comm: mytest Not tainted 6.16.0-rc7 #203 PREEMPT(voluntary)   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014   RIP: 0010:skb_pull_rcsum+0x8e/0xa0   Code: 00 00 5b c3 cc cc cc cc 8b 93 88 00 00 00 f7 da e8 37 44 38 00 f7 d8 89 83 88 00 00 00 48 8b 83 c8 00 00 00 5b c3 cc cc cc cc <0f> 0b 0f 0b 66 66 2e 0f 1f 84 00 000   RSP: 0018:ffffc900001fba38 EFLAGS: 00000297   RAX: 0000000000000004 RBX: ffff8880040c1000 RCX: ffffc900001fb948   RDX: ffff888003e6d700 RSI: 0000000000000008 RDI: ffff88800411a062   RBP: ffff8880040c1000 R08: 0000000000000000 R09: 0000000000000001   R10: ffff888003606c00 R11: 0000000000000001 R12: 0000000000000000   R13: ffff888004060900 R14: ffff888004050000 R15: ffff888004060900   FS:  000000002406d3c0(0000) GS:ffff888084a19000(0000) knlGS:0000000000000000   CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033   CR2: 0000000020000040 CR3: 0000000004007000 CR4: 00000000000006f0   Call Trace:    <TASK>    udp_queue_rcv_one_skb+0x176/0x4b0 net/ipv4/udp.c:2445    udp_queue_rcv_skb+0x155/0x1f0 net/ipv4/udp.c:2475    udp_unicast_rcv_skb+0x71/0x90 net/ipv4/udp.c:2626    __udp4_lib_rcv+0x433/0xb00 net/ipv4/udp.c:2690    ip_protocol_deliver_rcu+0xa6/0x160 net/ipv4/ip_input.c:205    ip_local_deliver_finish+0x72/0x90 net/ipv4/ip_input.c:233    ip_sublist_rcv_finish+0x5f/0x70 net/ipv4/ip_input.c:579    ip_sublist_rcv+0x122/0x1b0 net/ipv4/ip_input.c:636    ip_list_rcv+0xf7/0x130 net/ipv4/ip_input.c:670    __netif_receive_skb_list_core+0x21d/0x240 net/core/dev.c:6067    netif_receive_skb_list_internal+0x186/0x2b0 net/core/dev.c:6210    napi_complete_done+0x78/0x180 net/core/dev.c:6580    tun_get_user+0xa63/0x1120 drivers/net/tun.c:1909    tun_chr_write_iter+0x65/0xb0 drivers/net/tun.c:1984    vfs_write+0x300/0x420 fs/read_write.c:593    ksys_write+0x60/0xd0 fs/read_write.c:686    do_syscall_64+0x50/0x1c0 arch/x86/entry/syscall_64.c:63    </TASK>  To trigger gso segment in udp_queue_rcv_skb(), we should also set option UDP_ENCAP_ESPINUDP to enable udp_sk(sk)->encap_rcv. When the encap_rcv hook return 1 in udp_queue_rcv_one_skb(), udp_csum_pull_header() will try to pull udphdr, but the skb size has been segmented to gso size, which leads to this crash.  Previous commit cf329aa42b66 (\"udp: cope with UDP GRO packet misdirection\") introduces segmentation in UDP receive path only for GRO, which was never intended to be used for UFO, so drop UFO packets in udp_rcv_segment().",
  "id": "DEBIAN-CVE-2025-38622",
  "modified": "2025-09-24T00:56:32.562723Z",
  "published": "2025-08-22T16:15:35Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2025-38622"
    }
  ],
  "schema_version": "1.7.3"
}