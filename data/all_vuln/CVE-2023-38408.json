{
  "details": "The PKCS#11 feature in ssh-agent in OpenSSH before 9.3p2 has an insufficiently trustworthy search path, leading to remote code execution if an agent is forwarded to an attacker-controlled system. (Code in /usr/lib is not necessarily safe for loading into ssh-agent.) NOTE: this issue exists because of an incomplete fix for CVE-2016-10009.",
  "id": "CVE-2023-38408",
  "modified": "2025-08-09T19:01:26Z",
  "published": "2023-07-20T03:15:10Z",
  "references": [
    {
      "type": "EVIDENCE",
      "url": "http://packetstormsecurity.com/files/173661/OpenSSH-Forwarded-SSH-Agent-Remote-Code-Execution.html"
    },
    {
      "type": "EVIDENCE",
      "url": "http://www.openwall.com/lists/oss-security/2023/07/20/1"
    },
    {
      "type": "ARTICLE",
      "url": "http://www.openwall.com/lists/oss-security/2023/07/20/2"
    },
    {
      "type": "ADVISORY",
      "url": "https://blog.qualys.com/vulnerabilities-threat-research/2023/07/19/cve-2023-38408-remote-code-execution-in-opensshs-forwarded-ssh-agent"
    },
    {
      "type": "ADVISORY",
      "url": "https://security.gentoo.org/glsa/202307-01"
    },
    {
      "type": "ADVISORY",
      "url": "https://security.netapp.com/advisory/ntap-20230803-0010/"
    },
    {
      "type": "ADVISORY",
      "url": "https://www.openssh.com/security.html"
    },
    {
      "type": "ADVISORY",
      "url": "https://www.openssh.com/txt/release-9.3p2"
    },
    {
      "type": "EVIDENCE",
      "url": "https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.txt"
    },
    {
      "type": "FIX",
      "url": "https://github.com/openbsd/src/commit/7bc29a9d5cd697290aa056e94ecee6253d3425f8"
    },
    {
      "type": "FIX",
      "url": "https://github.com/openbsd/src/commit/f03a4faa55c4ce0818324701dadbf91988d7351d"
    },
    {
      "type": "FIX",
      "url": "https://github.com/openbsd/src/commit/f8f5a6b003981bb824329dc987d101977beda7ca"
    },
    {
      "type": "REPORT",
      "url": "https://news.ycombinator.com/item?id=36790196"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2023/09/22/11"
    },
    {
      "type": "WEB",
      "url": "http://www.openwall.com/lists/oss-security/2023/09/22/9"
    },
    {
      "type": "WEB",
      "url": "https://lists.debian.org/debian-lts-announce/2023/08/msg00021.html"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CEBTJJINE2I3FHAUKKNQWMFGYMLSMWKQ/"
    },
    {
      "type": "WEB",
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RAXVQS6ZYTULFAK3TEJHRLKZALJS3AOU/"
    },
    {
      "type": "WEB",
      "url": "https://support.apple.com/kb/HT213940"
    },
    {
      "type": "WEB",
      "url": "https://www.vicarius.io/vsociety/posts/exploring-opensshs-agent-forwarding-rce-cve-2023-38408"
    }
  ],
  "related": [
    "ALSA-2023:4412",
    "ALSA-2023:4419",
    "CGA-wfw4-m8r2-5q9c",
    "MGASA-2024-0010",
    "RLSA-2023:4419",
    "SUSE-SU-2023:2940-1",
    "SUSE-SU-2023:2945-1",
    "SUSE-SU-2023:2946-1",
    "SUSE-SU-2023:2947-1",
    "SUSE-SU-2023:2950-1",
    "openSUSE-SU-2024:13063-1"
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ]
}