{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49851.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:11",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "5.10.158-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "5.10.103-1",
        "5.10.103-1~bpo10+1",
        "5.10.106-1",
        "5.10.113-1",
        "5.10.120-1",
        "5.10.120-1~bpo10+1",
        "5.10.127-1",
        "5.10.127-2",
        "5.10.127-2~bpo10+1",
        "5.10.136-1",
        "5.10.140-1",
        "5.10.148-1",
        "5.10.149-1",
        "5.10.149-2",
        "5.10.46-4",
        "5.10.46-5",
        "5.10.70-1",
        "5.10.70-1~bpo10+1",
        "5.10.84-1",
        "5.10.92-1",
        "5.10.92-1~bpo10+1",
        "5.10.92-2"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49851.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.0.10-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49851.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.0.10-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-49851.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.0.10-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  riscv: fix reserved memory setup  Currently, RISC-V sets up reserved memory using the \"early\" copy of the device tree. As a result, when trying to get a reserved memory region using of_reserved_mem_lookup(), the pointer to reserved memory regions is using the early, pre-virtual-memory address which causes a kernel panic when trying to use the buffer's name:   Unable to handle kernel paging request at virtual address 00000000401c31ac  Oops [#1]  Modules linked in:  CPU: 0 PID: 0 Comm: swapper Not tainted 6.0.0-rc1-00001-g0d9d6953d834 #1  Hardware name: Microchip PolarFire-SoC Icicle Kit (DT)  epc : string+0x4a/0xea   ra : vsnprintf+0x1e4/0x336  epc : ffffffff80335ea0 ra : ffffffff80338936 sp : ffffffff81203be0   gp : ffffffff812e0a98 tp : ffffffff8120de40 t0 : 0000000000000000   t1 : ffffffff81203e28 t2 : 7265736572203a46 s0 : ffffffff81203c20   s1 : ffffffff81203e28 a0 : ffffffff81203d22 a1 : 0000000000000000   a2 : ffffffff81203d08 a3 : 0000000081203d21 a4 : ffffffffffffffff   a5 : 00000000401c31ac a6 : ffff0a00ffffff04 a7 : ffffffffffffffff   s2 : ffffffff81203d08 s3 : ffffffff81203d00 s4 : 0000000000000008   s5 : ffffffff000000ff s6 : 0000000000ffffff s7 : 00000000ffffff00   s8 : ffffffff80d9821a s9 : ffffffff81203d22 s10: 0000000000000002   s11: ffffffff80d9821c t3 : ffffffff812f3617 t4 : ffffffff812f3617   t5 : ffffffff812f3618 t6 : ffffffff81203d08  status: 0000000200000100 badaddr: 00000000401c31ac cause: 000000000000000d  [<ffffffff80338936>] vsnprintf+0x1e4/0x336  [<ffffffff80055ae2>] vprintk_store+0xf6/0x344  [<ffffffff80055d86>] vprintk_emit+0x56/0x192  [<ffffffff80055ed8>] vprintk_default+0x16/0x1e  [<ffffffff800563d2>] vprintk+0x72/0x80  [<ffffffff806813b2>] _printk+0x36/0x50  [<ffffffff8068af48>] print_reserved_mem+0x1c/0x24  [<ffffffff808057ec>] paging_init+0x528/0x5bc  [<ffffffff808031ae>] setup_arch+0xd0/0x592  [<ffffffff8080070e>] start_kernel+0x82/0x73c  early_init_fdt_scan_reserved_mem() takes no arguments as it operates on initial_boot_params, which is populated by early_init_dt_verify(). On RISC-V, early_init_dt_verify() is called twice. Once, directly, in setup_arch() if CONFIG_BUILTIN_DTB is not enabled and once indirectly, very early in the boot process, by parse_dtb() when it calls early_init_dt_scan_nodes().  This first call uses dtb_early_va to set initial_boot_params, which is not usable later in the boot process when early_init_fdt_scan_reserved_mem() is called. On arm64 for example, the corresponding call to early_init_dt_scan_nodes() uses fixmap addresses and doesn't suffer the same fate.  Move early_init_fdt_scan_reserved_mem() further along the boot sequence, after the direct call to early_init_dt_verify() in setup_arch() so that the names use the correct virtual memory addresses. The above supposed that CONFIG_BUILTIN_DTB was not set, but should work equally in the case where it is - unflatted_and_copy_device_tree() also updates initial_boot_params.",
  "id": "DEBIAN-CVE-2022-49851",
  "modified": "2025-09-25T03:20:20.658593Z",
  "published": "2025-05-01T15:16:08Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2022-49851"
    }
  ],
  "schema_version": "1.7.3",
  "upstream": [
    "CVE-2022-49851"
  ]
}