{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-27022.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:12",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.1.90-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1~bpo11+1"
      ]
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-27022.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:13",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.9-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    },
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2024-27022.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.8.9-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": []
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  fork: defer linking file vma until vma is fully initialized  Thorvald reported a WARNING [1]. And the root cause is below race:   CPU 1\t\t\t\t\tCPU 2  fork\t\t\t\t\thugetlbfs_fallocate   dup_mmap\t\t\t\t hugetlbfs_punch_hole    i_mmap_lock_write(mapping);    vma_interval_tree_insert_after -- Child vma is visible through i_mmap tree.    i_mmap_unlock_write(mapping);    hugetlb_dup_vma_private -- Clear vma_lock outside i_mmap_rwsem! \t\t\t\t\t i_mmap_lock_write(mapping);    \t\t\t\t\t hugetlb_vmdelete_list \t\t\t\t\t  vma_interval_tree_foreach \t\t\t\t\t   hugetlb_vma_trylock_write -- Vma_lock is cleared.    tmp->vm_ops->open -- Alloc new vma_lock outside i_mmap_rwsem! \t\t\t\t\t   hugetlb_vma_unlock_write -- Vma_lock is assigned!!! \t\t\t\t\t i_mmap_unlock_write(mapping);  hugetlb_dup_vma_private() and hugetlb_vm_op_open() are called outside i_mmap_rwsem lock while vma lock can be used in the same time.  Fix this by deferring linking file vma until vma is fully initialized.  Those vmas should be initialized first before they can be used.",
  "id": "DEBIAN-CVE-2024-27022",
  "modified": "2025-09-30T05:18:18.661197Z",
  "published": "2024-05-01T06:15:21Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2024-27022"
    }
  ],
  "schema_version": "1.7.3",
  "severity": [
    {
      "score": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "type": "CVSS_V3"
    }
  ],
  "upstream": [
    "CVE-2024-27022"
  ]
}