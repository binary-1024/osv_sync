{
  "id": "CVE-2025-21888",
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/mlx5: Fix a WARN during dereg_mr for DM type\n\nMemory regions (MR) of type DM (device memory) do not have an associated\numem.\n\nIn the __mlx5_ib_dereg_mr() -> mlx5_free_priv_descs() flow, the code\nincorrectly takes the wrong branch, attempting to call\ndma_unmap_single() on a DMA address that is not mapped.\n\nThis results in a WARN [1], as shown below.\n\nThe issue is resolved by properly accounting for the DM type and\nensuring the correct branch is selected in mlx5_free_priv_descs().\n\n[1]\nWARNING: CPU: 12 PID: 1346 at drivers/iommu/dma-iommu.c:1230 iommu_dma_unmap_page+0x79/0x90\nModules linked in: ip6table_mangle ip6table_nat ip6table_filter ip6_tables iptable_mangle xt_conntrack xt_MASQUERADE nf_conntrack_netlink nfnetlink xt_addrtype iptable_nat nf_nat br_netfilter rpcsec_gss_krb5 auth_rpcgss oid_registry ovelay rpcrdma rdma_ucm ib_iser libiscsi scsi_transport_iscsi ib_umad rdma_cm ib_ipoib iw_cm ib_cm mlx5_ib ib_uverbs ib_core fuse mlx5_core\nCPU: 12 UID: 0 PID: 1346 Comm: ibv_rc_pingpong Not tainted 6.12.0-rc7+ #1631\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nRIP: 0010:iommu_dma_unmap_page+0x79/0x90\nCode: 2b 49 3b 29 72 26 49 3b 69 08 73 20 4d 89 f0 44 89 e9 4c 89 e2 48 89 ee 48 89 df 5b 5d 41 5c 41 5d 41 5e 41 5f e9 07 b8 88 ff <0f> 0b 5b 5d 41 5c 41 5d 41 5e 41 5f c3 cc cc cc cc 66 0f 1f 44 00\nRSP: 0018:ffffc90001913a10 EFLAGS: 00010246\nRAX: 0000000000000000 RBX: ffff88810194b0a8 RCX: 0000000000000000\nRDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000001\nRBP: ffff88810194b0a8 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000001 R11: 0000000000000000 R12: 0000000000000000\nR13: 0000000000000001 R14: 0000000000000000 R15: 0000000000000000\nFS:  00007f537abdd740(0000) GS:ffff88885fb00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f537aeb8000 CR3: 000000010c248001 CR4: 0000000000372eb0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n<TASK>\n? __warn+0x84/0x190\n? iommu_dma_unmap_page+0x79/0x90\n? report_bug+0xf8/0x1c0\n? handle_bug+0x55/0x90\n? exc_invalid_op+0x13/0x60\n? asm_exc_invalid_op+0x16/0x20\n? iommu_dma_unmap_page+0x79/0x90\ndma_unmap_page_attrs+0xe6/0x290\nmlx5_free_priv_descs+0xb0/0xe0 [mlx5_ib]\n__mlx5_ib_dereg_mr+0x37e/0x520 [mlx5_ib]\n? _raw_spin_unlock_irq+0x24/0x40\n? wait_for_completion+0xfe/0x130\n? rdma_restrack_put+0x63/0xe0 [ib_core]\nib_dereg_mr_user+0x5f/0x120 [ib_core]\n? lock_release+0xc6/0x280\ndestroy_hw_idr_uobject+0x1d/0x60 [ib_uverbs]\nuverbs_destroy_uobject+0x58/0x1d0 [ib_uverbs]\nuobj_destroy+0x3f/0x70 [ib_uverbs]\nib_uverbs_cmd_verbs+0x3e4/0xbb0 [ib_uverbs]\n? __pfx_uverbs_destroy_def_handler+0x10/0x10 [ib_uverbs]\n? lock_acquire+0xc1/0x2f0\n? ib_uverbs_ioctl+0xcb/0x170 [ib_uverbs]\n? ib_uverbs_ioctl+0x116/0x170 [ib_uverbs]\n? lock_release+0xc6/0x280\nib_uverbs_ioctl+0xe7/0x170 [ib_uverbs]\n? ib_uverbs_ioctl+0xcb/0x170 [ib_uverbs]\n__x64_sys_ioctl+0x1b0/0xa70\ndo_syscall_64+0x6b/0x140\nentry_SYSCALL_64_after_hwframe+0x76/0x7e\nRIP: 0033:0x7f537adaf17b\nCode: 0f 1e fa 48 8b 05 1d ad 0c 00 64 c7 00 26 00 00 00 48 c7 c0 ff ff ff ff c3 66 0f 1f 44 00 00 f3 0f 1e fa b8 10 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d ed ac 0c 00 f7 d8 64 89 01 48\nRSP: 002b:00007ffff218f0b8 EFLAGS: 00000246 ORIG_RAX: 0000000000000010\nRAX: ffffffffffffffda RBX: 00007ffff218f1d8 RCX: 00007f537adaf17b\nRDX: 00007ffff218f1c0 RSI: 00000000c0181b01 RDI: 0000000000000003\nRBP: 00007ffff218f1a0 R08: 00007f537aa8d010 R09: 0000561ee2e4f270\nR10: 00007f537aace3a8 R11: 0000000000000246 R12: 00007ffff218f190\nR13: 000000000000001c R14: 0000561ee2e4d7c0 R15: 00007ffff218f450\n</TASK>",
  "modified": "2025-03-27T20:55:52.281814Z",
  "published": "2025-03-27T15:15:56Z",
  "related": [
    "SUSE-SU-2025:1177-1",
    "SUSE-SU-2025:1178-1",
    "SUSE-SU-2025:1180-1",
    "UBUNTU-CVE-2025-21888",
    "USN-7514-1",
    "USN-7521-1",
    "USN-7521-2",
    "USN-7521-3",
    "USN-7522-1"
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/0bd34bdd468e93a779c403de3cf7d43ee633b3e0"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/abc7b3f1f056d69a8f11d6dceecc0c9549ace770"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f1298cad47ae29828c5c5be77e733ccfcaef6a7f"
    },
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2025-21888"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "linux",
        "ecosystem": "Debian:12",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "6.1.106-1",
        "6.1.106-2",
        "6.1.106-3",
        "6.1.112-1",
        "6.1.115-1",
        "6.1.119-1",
        "6.1.123-1",
        "6.1.124-1",
        "6.1.128-1",
        "6.1.129-1",
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1",
        "6.1.90-1~bpo11+1",
        "6.1.94-1",
        "6.1.94-1~bpo11+1",
        "6.1.98-1",
        "6.1.99-1",
        "6.10-1~exp1",
        "6.10.1-1~exp1",
        "6.10.11-1",
        "6.10.11-1~bpo12+1",
        "6.10.12-1",
        "6.10.3-1",
        "6.10.4-1",
        "6.10.6-1",
        "6.10.6-1~bpo12+1",
        "6.10.7-1",
        "6.10.9-1",
        "6.11-1~exp1",
        "6.11.10-1",
        "6.11.10-1~bpo12+1",
        "6.11.2-1",
        "6.11.4-1",
        "6.11.5-1",
        "6.11.5-1~bpo12+1",
        "6.11.6-1",
        "6.11.7-1",
        "6.11.9-1",
        "6.11~rc4-1~exp1",
        "6.11~rc5-1~exp1",
        "6.12.10-1",
        "6.12.11-1",
        "6.12.11-1+alpha",
        "6.12.11-1+alpha.1",
        "6.12.12-1",
        "6.12.12-1~bpo12+1",
        "6.12.13-1",
        "6.12.15-1",
        "6.12.16-1",
        "6.12.17-1",
        "6.12.19-1",
        "6.12.20-1",
        "6.12.3-1",
        "6.12.5-1",
        "6.12.6-1",
        "6.12.8-1",
        "6.12.9-1",
        "6.12.9-1+alpha",
        "6.12.9-1~bpo12+1",
        "6.12~rc6-1~exp1",
        "6.13.2-1~exp1",
        "6.13.3-1~exp1",
        "6.13.4-1~exp1",
        "6.13.5-1~exp1",
        "6.13.6-1~exp1",
        "6.13.7-1~exp1",
        "6.13.8-1~exp1",
        "6.13~rc6-1~exp1",
        "6.13~rc7-1~exp1",
        "6.3.1-1~exp1",
        "6.3.11-1",
        "6.3.2-1~exp1",
        "6.3.4-1~exp1",
        "6.3.5-1~exp1",
        "6.3.7-1",
        "6.3.7-1~bpo12+1",
        "6.4.1-1~exp1",
        "6.4.11-1",
        "6.4.13-1",
        "6.4.4-1",
        "6.4.4-1~bpo12+1",
        "6.4.4-2",
        "6.4.4-3",
        "6.4.4-3~bpo12+1",
        "6.4~rc6-1~exp1",
        "6.4~rc7-1~exp1",
        "6.5.1-1~exp1",
        "6.5.10-1",
        "6.5.10-1~bpo12+1",
        "6.5.13-1",
        "6.5.3-1",
        "6.5.3-1~bpo12+1",
        "6.5.6-1",
        "6.5.8-1",
        "6.5~rc4-1~exp1",
        "6.5~rc6-1~exp1",
        "6.5~rc7-1~exp1",
        "6.6.11-1",
        "6.6.13-1",
        "6.6.13-1~bpo12+1",
        "6.6.15-1",
        "6.6.15-2",
        "6.6.3-1~exp1",
        "6.6.4-1~exp1",
        "6.6.7-1~exp1",
        "6.6.8-1",
        "6.6.9-1",
        "6.7-1~exp1",
        "6.7.1-1~exp1",
        "6.7.12-1",
        "6.7.12-1~bpo12+1",
        "6.7.4-1~exp1",
        "6.7.7-1",
        "6.7.9-1",
        "6.7.9-2",
        "6.8.11-1",
        "6.8.12-1",
        "6.8.12-1~bpo12+1",
        "6.8.9-1",
        "6.9.10-1",
        "6.9.10-1~bpo12+1",
        "6.9.11-1",
        "6.9.12-1",
        "6.9.2-1~exp1",
        "6.9.7-1",
        "6.9.7-1~bpo12+1",
        "6.9.8-1",
        "6.9.9-1"
      ],
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21888.json"
      }
    },
    {
      "package": {
        "name": "linux",
        "ecosystem": "Debian:13",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.12.19-1"
            }
          ]
        }
      ],
      "versions": [
        "6.1.106-1",
        "6.1.106-2",
        "6.1.106-3",
        "6.1.112-1",
        "6.1.115-1",
        "6.1.119-1",
        "6.1.123-1",
        "6.1.124-1",
        "6.1.128-1",
        "6.1.129-1",
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1",
        "6.1.90-1~bpo11+1",
        "6.1.94-1",
        "6.1.94-1~bpo11+1",
        "6.1.98-1",
        "6.1.99-1",
        "6.10-1~exp1",
        "6.10.1-1~exp1",
        "6.10.11-1",
        "6.10.11-1~bpo12+1",
        "6.10.12-1",
        "6.10.3-1",
        "6.10.4-1",
        "6.10.6-1",
        "6.10.6-1~bpo12+1",
        "6.10.7-1",
        "6.10.9-1",
        "6.11-1~exp1",
        "6.11.10-1",
        "6.11.10-1~bpo12+1",
        "6.11.2-1",
        "6.11.4-1",
        "6.11.5-1",
        "6.11.5-1~bpo12+1",
        "6.11.6-1",
        "6.11.7-1",
        "6.11.9-1",
        "6.11~rc4-1~exp1",
        "6.11~rc5-1~exp1",
        "6.12.10-1",
        "6.12.11-1",
        "6.12.11-1+alpha",
        "6.12.11-1+alpha.1",
        "6.12.12-1",
        "6.12.12-1~bpo12+1",
        "6.12.13-1",
        "6.12.15-1",
        "6.12.16-1",
        "6.12.17-1",
        "6.12.3-1",
        "6.12.5-1",
        "6.12.6-1",
        "6.12.8-1",
        "6.12.9-1",
        "6.12.9-1+alpha",
        "6.12.9-1~bpo12+1",
        "6.12~rc6-1~exp1",
        "6.3.1-1~exp1",
        "6.3.11-1",
        "6.3.2-1~exp1",
        "6.3.4-1~exp1",
        "6.3.5-1~exp1",
        "6.3.7-1",
        "6.3.7-1~bpo12+1",
        "6.4.1-1~exp1",
        "6.4.11-1",
        "6.4.13-1",
        "6.4.4-1",
        "6.4.4-1~bpo12+1",
        "6.4.4-2",
        "6.4.4-3",
        "6.4.4-3~bpo12+1",
        "6.4~rc6-1~exp1",
        "6.4~rc7-1~exp1",
        "6.5.1-1~exp1",
        "6.5.10-1",
        "6.5.10-1~bpo12+1",
        "6.5.13-1",
        "6.5.3-1",
        "6.5.3-1~bpo12+1",
        "6.5.6-1",
        "6.5.8-1",
        "6.5~rc4-1~exp1",
        "6.5~rc6-1~exp1",
        "6.5~rc7-1~exp1",
        "6.6.11-1",
        "6.6.13-1",
        "6.6.13-1~bpo12+1",
        "6.6.15-1",
        "6.6.15-2",
        "6.6.3-1~exp1",
        "6.6.4-1~exp1",
        "6.6.7-1~exp1",
        "6.6.8-1",
        "6.6.9-1",
        "6.7-1~exp1",
        "6.7.1-1~exp1",
        "6.7.12-1",
        "6.7.12-1~bpo12+1",
        "6.7.4-1~exp1",
        "6.7.7-1",
        "6.7.9-1",
        "6.7.9-2",
        "6.8.11-1",
        "6.8.12-1",
        "6.8.12-1~bpo12+1",
        "6.8.9-1",
        "6.9.10-1",
        "6.9.10-1~bpo12+1",
        "6.9.11-1",
        "6.9.12-1",
        "6.9.2-1~exp1",
        "6.9.7-1",
        "6.9.7-1~bpo12+1",
        "6.9.8-1",
        "6.9.9-1"
      ],
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-21888.json"
      }
    }
  ],
  "schema_version": "1.6.0"
}