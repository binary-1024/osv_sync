{
  "id": "CVE-2025-22091",
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/mlx5: Fix page_size variable overflow\n\nChange all variables storing mlx5_umem_mkc_find_best_pgsz() result to\nunsigned long to support values larger than 31 and avoid overflow.\n\nFor example: If we try to register 4GB of memory that is contiguous in\nphysical memory, the driver will optimize the page_size and try to use\nan mkey with 4GB entity size. The 'unsigned int' page_size variable will\noverflow to '0' and we'll hit the WARN_ON() in alloc_cacheable_mr().\n\nWARNING: CPU: 2 PID: 1203 at drivers/infiniband/hw/mlx5/mr.c:1124 alloc_cacheable_mr+0x22/0x580 [mlx5_ib]\nModules linked in: mlx5_ib mlx5_core bonding ip6_gre ip6_tunnel tunnel6 ip_gre gre rdma_rxe rdma_ucm ib_uverbs ib_ipoib ib_umad rpcrdma ib_iser libiscsi scsi_transport_iscsi rdma_cm iw_cm ib_cm fuse ib_core [last unloaded: mlx5_core]\nCPU: 2 UID: 70878 PID: 1203 Comm: rdma_resource_l Tainted: G        W          6.14.0-rc4-dirty #43\nTainted: [W]=WARN\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nRIP: 0010:alloc_cacheable_mr+0x22/0x580 [mlx5_ib]\nCode: 90 90 90 90 90 90 90 90 0f 1f 44 00 00 55 48 89 e5 41 57 41 56 41 55 41 54 41 52 53 48 83 ec 30 f6 46 28 04 4c 8b 77 08 75 21 <0f> 0b 49 c7 c2 ea ff ff ff 48 8d 65 d0 4c 89 d0 5b 41 5a 41 5c 41\nRSP: 0018:ffffc900006ffac8 EFLAGS: 00010246\nRAX: 0000000004c0d0d0 RBX: ffff888217a22000 RCX: 0000000000100001\nRDX: 00007fb7ac480000 RSI: ffff8882037b1240 RDI: ffff8882046f0600\nRBP: ffffc900006ffb28 R08: 0000000000000001 R09: 0000000000000000\nR10: 00000000000007e0 R11: ffffea0008011d40 R12: ffff8882037b1240\nR13: ffff8882046f0600 R14: ffff888217a22000 R15: ffffc900006ffe00\nFS:  00007fb7ed013340(0000) GS:ffff88885fd00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007fb7ed1d8000 CR3: 00000001fd8f6006 CR4: 0000000000772eb0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nPKRU: 55555554\nCall Trace:\n <TASK>\n ? __warn+0x81/0x130\n ? alloc_cacheable_mr+0x22/0x580 [mlx5_ib]\n ? report_bug+0xfc/0x1e0\n ? handle_bug+0x55/0x90\n ? exc_invalid_op+0x17/0x70\n ? asm_exc_invalid_op+0x1a/0x20\n ? alloc_cacheable_mr+0x22/0x580 [mlx5_ib]\n create_real_mr+0x54/0x150 [mlx5_ib]\n ib_uverbs_reg_mr+0x17f/0x2a0 [ib_uverbs]\n ib_uverbs_handler_UVERBS_METHOD_INVOKE_WRITE+0xca/0x140 [ib_uverbs]\n ib_uverbs_run_method+0x6d0/0x780 [ib_uverbs]\n ? __pfx_ib_uverbs_handler_UVERBS_METHOD_INVOKE_WRITE+0x10/0x10 [ib_uverbs]\n ib_uverbs_cmd_verbs+0x19b/0x360 [ib_uverbs]\n ? walk_system_ram_range+0x79/0xd0\n ? ___pte_offset_map+0x1b/0x110\n ? __pte_offset_map_lock+0x80/0x100\n ib_uverbs_ioctl+0xac/0x110 [ib_uverbs]\n __x64_sys_ioctl+0x94/0xb0\n do_syscall_64+0x50/0x110\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\nRIP: 0033:0x7fb7ecf0737b\nCode: ff ff ff 85 c0 79 9b 49 c7 c4 ff ff ff ff 5b 5d 4c 89 e0 41 5c c3 66 0f 1f 84 00 00 00 00 00 f3 0f 1e fa b8 10 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 7d 2a 0f 00 f7 d8 64 89 01 48\nRSP: 002b:00007ffdbe03ecc8 EFLAGS: 00000246 ORIG_RAX: 0000000000000010\nRAX: ffffffffffffffda RBX: 00007ffdbe03edb8 RCX: 00007fb7ecf0737b\nRDX: 00007ffdbe03eda0 RSI: 00000000c0181b01 RDI: 0000000000000003\nRBP: 00007ffdbe03ed80 R08: 00007fb7ecc84010 R09: 00007ffdbe03eed4\nR10: 0000000000000009 R11: 0000000000000246 R12: 00007ffdbe03eed4\nR13: 000000000000000c R14: 000000000000000c R15: 00007fb7ecc84150\n </TASK>",
  "modified": "2025-05-05T17:54:06.196277Z",
  "published": "2025-04-16T15:16:03Z",
  "related": [
    "SUSE-SU-2025:01951-1",
    "SUSE-SU-2025:01967-1",
    "UBUNTU-CVE-2025-22091",
    "USN-7594-1",
    "USN-7594-2"
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/01fd737776ca0f17a96d83cd7f0840ce130b9a02"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/05b215d5e219c0228b9c7082ba9bcf176c576646"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/e0c09f639ca0e102f250df8787740c2013e9d1b3"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/f0c2427412b43cdf1b7b0944749ea17ddb97d5a5"
    },
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2025-22091"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "linux",
        "ecosystem": "Debian:13",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.12.25-1"
            }
          ]
        }
      ],
      "versions": [
        "6.1.106-1",
        "6.1.106-2",
        "6.1.106-3",
        "6.1.112-1",
        "6.1.115-1",
        "6.1.119-1",
        "6.1.123-1",
        "6.1.124-1",
        "6.1.128-1",
        "6.1.129-1",
        "6.1.133-1",
        "6.1.135-1",
        "6.1.27-1",
        "6.1.37-1",
        "6.1.38-1",
        "6.1.38-2",
        "6.1.38-2~bpo11+1",
        "6.1.38-3",
        "6.1.38-4",
        "6.1.38-4~bpo11+1",
        "6.1.52-1",
        "6.1.55-1",
        "6.1.55-1~bpo11+1",
        "6.1.64-1",
        "6.1.66-1",
        "6.1.67-1",
        "6.1.69-1",
        "6.1.69-1~bpo11+1",
        "6.1.76-1",
        "6.1.76-1~bpo11+1",
        "6.1.82-1",
        "6.1.85-1",
        "6.1.90-1",
        "6.1.90-1~bpo11+1",
        "6.1.94-1",
        "6.1.94-1~bpo11+1",
        "6.1.98-1",
        "6.1.99-1",
        "6.10-1~exp1",
        "6.10.1-1~exp1",
        "6.10.11-1",
        "6.10.11-1~bpo12+1",
        "6.10.12-1",
        "6.10.3-1",
        "6.10.4-1",
        "6.10.6-1",
        "6.10.6-1~bpo12+1",
        "6.10.7-1",
        "6.10.9-1",
        "6.11-1~exp1",
        "6.11.10-1",
        "6.11.10-1~bpo12+1",
        "6.11.2-1",
        "6.11.4-1",
        "6.11.5-1",
        "6.11.5-1~bpo12+1",
        "6.11.6-1",
        "6.11.7-1",
        "6.11.9-1",
        "6.11~rc4-1~exp1",
        "6.11~rc5-1~exp1",
        "6.12.10-1",
        "6.12.11-1",
        "6.12.11-1+alpha",
        "6.12.11-1+alpha.1",
        "6.12.12-1",
        "6.12.12-1~bpo12+1",
        "6.12.13-1",
        "6.12.15-1",
        "6.12.16-1",
        "6.12.17-1",
        "6.12.19-1",
        "6.12.20-1",
        "6.12.21-1",
        "6.12.22-1",
        "6.12.22-1~bpo12+1",
        "6.12.3-1",
        "6.12.5-1",
        "6.12.6-1",
        "6.12.8-1",
        "6.12.9-1",
        "6.12.9-1+alpha",
        "6.12.9-1~bpo12+1",
        "6.12~rc6-1~exp1",
        "6.3.1-1~exp1",
        "6.3.11-1",
        "6.3.2-1~exp1",
        "6.3.4-1~exp1",
        "6.3.5-1~exp1",
        "6.3.7-1",
        "6.3.7-1~bpo12+1",
        "6.4.1-1~exp1",
        "6.4.11-1",
        "6.4.13-1",
        "6.4.4-1",
        "6.4.4-1~bpo12+1",
        "6.4.4-2",
        "6.4.4-3",
        "6.4.4-3~bpo12+1",
        "6.4~rc6-1~exp1",
        "6.4~rc7-1~exp1",
        "6.5.1-1~exp1",
        "6.5.10-1",
        "6.5.10-1~bpo12+1",
        "6.5.13-1",
        "6.5.3-1",
        "6.5.3-1~bpo12+1",
        "6.5.6-1",
        "6.5.8-1",
        "6.5~rc4-1~exp1",
        "6.5~rc6-1~exp1",
        "6.5~rc7-1~exp1",
        "6.6.11-1",
        "6.6.13-1",
        "6.6.13-1~bpo12+1",
        "6.6.15-1",
        "6.6.15-2",
        "6.6.3-1~exp1",
        "6.6.4-1~exp1",
        "6.6.7-1~exp1",
        "6.6.8-1",
        "6.6.9-1",
        "6.7-1~exp1",
        "6.7.1-1~exp1",
        "6.7.12-1",
        "6.7.12-1~bpo12+1",
        "6.7.4-1~exp1",
        "6.7.7-1",
        "6.7.9-1",
        "6.7.9-2",
        "6.8.11-1",
        "6.8.12-1",
        "6.8.12-1~bpo12+1",
        "6.8.9-1",
        "6.9.10-1",
        "6.9.10-1~bpo12+1",
        "6.9.11-1",
        "6.9.12-1",
        "6.9.2-1~exp1",
        "6.9.7-1",
        "6.9.7-1~bpo12+1",
        "6.9.8-1",
        "6.9.9-1"
      ],
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/cve-osv-conversion/osv-output/CVE-2025-22091.json"
      }
    }
  ],
  "schema_version": "1.6.0"
}