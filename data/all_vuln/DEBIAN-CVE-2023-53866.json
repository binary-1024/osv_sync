{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-53866","published":"2025-12-09T16:17:27.530Z","modified":"2026-01-05T17:09:43.974974Z","upstream":["CVE-2023-53866"],"details":"In the Linux kernel, the following vulnerability has been resolved:  ASoC: soc-compress: Reposition and add pcm_mutex  If panic_on_warn is set and compress stream(DPCM) is started, then kernel panic occurred because card->pcm_mutex isn't held appropriately. In the following functions, warning were issued at this line \"snd_soc_dpcm_mutex_assert_held\".  static int dpcm_be_connect(struct snd_soc_pcm_runtime *fe, \t\tstruct snd_soc_pcm_runtime *be, int stream) { \t... \tsnd_soc_dpcm_mutex_assert_held(fe); \t... }  void dpcm_be_disconnect(struct snd_soc_pcm_runtime *fe, int stream) { \t... \tsnd_soc_dpcm_mutex_assert_held(fe); \t... }  void snd_soc_runtime_action(struct snd_soc_pcm_runtime *rtd, \t\t\t    int stream, int action) { \t... \tsnd_soc_dpcm_mutex_assert_held(rtd); \t... }  int dpcm_dapm_stream_event(struct snd_soc_pcm_runtime *fe, int dir, \tint event) { \t... \tsnd_soc_dpcm_mutex_assert_held(fe); \t... }  These functions are called by soc_compr_set_params_fe, soc_compr_open_fe and soc_compr_free_fe without pcm_mutex locking. And this is call stack.  [  414.527841][ T2179] pc : dpcm_process_paths+0x5a4/0x750 [  414.527848][ T2179] lr : dpcm_process_paths+0x37c/0x750 [  414.527945][ T2179] Call trace: [  414.527949][ T2179]  dpcm_process_paths+0x5a4/0x750 [  414.527955][ T2179]  soc_compr_open_fe+0xb0/0x2cc [  414.527972][ T2179]  snd_compr_open+0x180/0x248 [  414.527981][ T2179]  snd_open+0x15c/0x194 [  414.528003][ T2179]  chrdev_open+0x1b0/0x220 [  414.528023][ T2179]  do_dentry_open+0x30c/0x594 [  414.528045][ T2179]  vfs_open+0x34/0x44 [  414.528053][ T2179]  path_openat+0x914/0xb08 [  414.528062][ T2179]  do_filp_open+0xc0/0x170 [  414.528068][ T2179]  do_sys_openat2+0x94/0x18c [  414.528076][ T2179]  __arm64_sys_openat+0x78/0xa4 [  414.528084][ T2179]  invoke_syscall+0x48/0x10c [  414.528094][ T2179]  el0_svc_common+0xbc/0x104 [  414.528099][ T2179]  do_el0_svc+0x34/0xd8 [  414.528103][ T2179]  el0_svc+0x34/0xc4 [  414.528125][ T2179]  el0t_64_sync_handler+0x8c/0xfc [  414.528133][ T2179]  el0t_64_sync+0x1a0/0x1a4 [  414.528142][ T2179] Kernel panic - not syncing: panic_on_warn set ...  So, I reposition and add pcm_mutex to resolve lockdep error.","affected":[{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.20-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53866.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.20-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53866.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.20-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53866.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-53866"}]}