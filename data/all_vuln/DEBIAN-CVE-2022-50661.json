{"schema_version":"1.7.3","id":"DEBIAN-CVE-2022-50661","published":"0001-01-01T00:00:00Z","modified":"2025-12-09T08:32:43.405410Z","upstream":["CVE-2022-50661"],"details":"In the Linux kernel, the following vulnerability has been resolved:  seccomp: Move copy_seccomp() to no failure path.  Our syzbot instance reported memory leaks in do_seccomp() [0], similar to the report [1].  It shows that we miss freeing struct seccomp_filter and some objects included in it.  We can reproduce the issue with the program below [2] which calls one seccomp() and two clone() syscalls.  The first clone()d child exits earlier than its parent and sends a signal to kill it during the second clone(), more precisely before the fatal_signal_pending() test in copy_process().  When the parent receives the signal, it has to destroy the embryonic process and return -EINTR to user space.  In the failure path, we have to call seccomp_filter_release() to decrement the filter's refcount.  Initially, we called it in free_task() called from the failure path, but the commit 3a15fb6ed92c (\"seccomp: release filter after task is fully dead\") moved it to release_task() to notify user space as early as possible that the filter is no longer used.  To keep the change and current seccomp refcount semantics, let's move copy_seccomp() just after the signal check and add a WARN_ON_ONCE() in free_task() for future debugging.  [0]: unreferenced object 0xffff8880063add00 (size 256):   comm \"repro_seccomp\", pid 230, jiffies 4294687090 (age 9.914s)   hex dump (first 32 bytes):     01 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00  ................     ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff  ................   backtrace:     do_seccomp (./include/linux/slab.h:600 ./include/linux/slab.h:733 kernel/seccomp.c:666 kernel/seccomp.c:708 kernel/seccomp.c:1871 kernel/seccomp.c:1991)     do_syscall_64 (arch/x86/entry/common.c:50 arch/x86/entry/common.c:80)     entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:120) unreferenced object 0xffffc90000035000 (size 4096):   comm \"repro_seccomp\", pid 230, jiffies 4294687090 (age 9.915s)   hex dump (first 32 bytes):     01 00 00 00 00 00 00 00 00 00 00 00 05 00 00 00  ................     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................   backtrace:     __vmalloc_node_range (mm/vmalloc.c:3226)     __vmalloc_node (mm/vmalloc.c:3261 (discriminator 4))     bpf_prog_alloc_no_stats (kernel/bpf/core.c:91)     bpf_prog_alloc (kernel/bpf/core.c:129)     bpf_prog_create_from_user (net/core/filter.c:1414)     do_seccomp (kernel/seccomp.c:671 kernel/seccomp.c:708 kernel/seccomp.c:1871 kernel/seccomp.c:1991)     do_syscall_64 (arch/x86/entry/common.c:50 arch/x86/entry/common.c:80)     entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:120) unreferenced object 0xffff888003fa1000 (size 1024):   comm \"repro_seccomp\", pid 230, jiffies 4294687090 (age 9.915s)   hex dump (first 32 bytes):     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................   backtrace:     bpf_prog_alloc_no_stats (./include/linux/slab.h:600 ./include/linux/slab.h:733 kernel/bpf/core.c:95)     bpf_prog_alloc (kernel/bpf/core.c:129)     bpf_prog_create_from_user (net/core/filter.c:1414)     do_seccomp (kernel/seccomp.c:671 kernel/seccomp.c:708 kernel/seccomp.c:1871 kernel/seccomp.c:1991)     do_syscall_64 (arch/x86/entry/common.c:50 arch/x86/entry/common.c:80)     entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:120) unreferenced object 0xffff888006360240 (size 16):   comm \"repro_seccomp\", pid 230, jiffies 4294687090 (age 9.915s)   hex dump (first 16 bytes):     01 00 37 00 76 65 72 6c e0 83 01 06 80 88 ff ff  ..7.verl........   backtrace:     bpf_prog_store_orig_filter (net/core/filter.c:1137)     bpf_prog_create_from_user (net/core/filter.c:1428)     do_seccomp (kernel/seccomp.c:671 kernel/seccomp.c:708 kernel/seccomp.c:1871 kernel/seccomp.c:1991)     do_syscall_64 (arch/x86/entry/common.c:50 arch/x86/entry/common.c:80)     entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:120) unreferenced object 0xffff888 ---truncated---","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.191-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.178-1","5.10.178-2","5.10.178-3","5.10.179-1","5.10.179-2","5.10.179-3","5.10.179-4","5.10.179-5","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50661.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50661.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50661.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50661.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2022-50661"}]}