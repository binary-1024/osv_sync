{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-54173","published":"2025-12-30T13:16:05.157Z","modified":"2025-12-31T11:10:07.924223Z","upstream":["CVE-2023-54173"],"details":"In the Linux kernel, the following vulnerability has been resolved:  bpf: Disable preemption in bpf_event_output  We received report [1] of kernel crash, which is caused by using nesting protection without disabled preemption.  The bpf_event_output can be called by programs executed by bpf_prog_run_array_cg function that disabled migration but keeps preemption enabled.  This can cause task to be preempted by another one inside the nesting protection and lead eventually to two tasks using same perf_sample_data buffer and cause crashes like:    BUG: kernel NULL pointer dereference, address: 0000000000000001   #PF: supervisor instruction fetch in kernel mode   #PF: error_code(0x0010) - not-present page   ...   ? perf_output_sample+0x12a/0x9a0   ? finish_task_switch.isra.0+0x81/0x280   ? perf_event_output+0x66/0xa0   ? bpf_event_output+0x13a/0x190   ? bpf_event_output_data+0x22/0x40   ? bpf_prog_dfc84bbde731b257_cil_sock4_connect+0x40a/0xacb   ? xa_load+0x87/0xe0   ? __cgroup_bpf_run_filter_sock_addr+0xc1/0x1a0   ? release_sock+0x3e/0x90   ? sk_setsockopt+0x1a1/0x12f0   ? udp_pre_connect+0x36/0x50   ? inet_dgram_connect+0x93/0xa0   ? __sys_connect+0xb4/0xe0   ? udp_setsockopt+0x27/0x40   ? __pfx_udp_push_pending_frames+0x10/0x10   ? __sys_setsockopt+0xdf/0x1a0   ? __x64_sys_connect+0xf/0x20   ? do_syscall_64+0x3a/0x90   ? entry_SYSCALL_64_after_hwframe+0x72/0xdc  Fixing this by disabling preemption in bpf_event_output.  [1] https://github.com/cilium/cilium/issues/26756","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.191-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.178-1","5.10.178-2","5.10.178-3","5.10.179-1","5.10.179-2","5.10.179-3","5.10.179-4","5.10.179-5","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54173.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.52-1"}]}],"versions":["6.1.27-1","6.1.37-1","6.1.38-1","6.1.38-2","6.1.38-2~bpo11+1","6.1.38-3","6.1.38-4","6.1.38-4~bpo11+1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54173.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.4.11-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54173.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.4.11-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-54173.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-54173"}]}