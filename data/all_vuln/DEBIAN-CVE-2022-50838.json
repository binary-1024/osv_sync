{"schema_version":"1.7.3","id":"DEBIAN-CVE-2022-50838","published":"2025-12-30T13:15:58.350Z","modified":"2025-12-31T11:10:03.554452Z","upstream":["CVE-2022-50838"],"details":"In the Linux kernel, the following vulnerability has been resolved:  net: stream: purge sk_error_queue in sk_stream_kill_queues()  Changheon Lee reported TCP socket leaks, with a nice repro.  It seems we leak TCP sockets with the following sequence:  1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.     Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().    __skb_tstamp_tx() is using skb_clone(), unless    SOF_TIMESTAMPING_OPT_TSONLY was also requested.  2) If the application is also using MSG_ZEROCOPY, then we put in the    error queue cloned skbs that had a struct ubuf_info attached to them.     Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()    does a sock_hold().     As long as the cloned skbs are still in sk_error_queue,    socket refcount is kept elevated.  3) Application closes the socket, while error queue is not empty.  Since tcp_close() no longer purges the socket error queue, we might end up with a TCP socket with at least one skb in error queue keeping the socket alive forever.  This bug can be (ab)used to consume all kernel memory and freeze the host.  We need to purge the error queue, with proper synchronization against concurrent writers.","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.178-1"}]}],"versions":["5.10.103-1","5.10.103-1~bpo10+1","5.10.106-1","5.10.113-1","5.10.120-1","5.10.120-1~bpo10+1","5.10.127-1","5.10.127-2","5.10.127-2~bpo10+1","5.10.136-1","5.10.140-1","5.10.148-1","5.10.149-1","5.10.149-2","5.10.158-1","5.10.158-2","5.10.162-1","5.10.46-4","5.10.46-5","5.10.70-1","5.10.70-1~bpo10+1","5.10.84-1","5.10.92-1","5.10.92-1~bpo10+1","5.10.92-2"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50838.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50838.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50838.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.1.4-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2022-50838.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2022-50838"}]}