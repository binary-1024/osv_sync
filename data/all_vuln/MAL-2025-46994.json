{
  "affected": [
    {
      "database_specific": {
        "cwes": [
          {
            "cweId": "CWE-506",
            "description": "The product contains code that appears to be malicious in nature.",
            "name": "Embedded Malicious Code"
          }
        ],
        "source": "https://github.com/ossf/malicious-packages/blob/main/osv/malicious/npm/duckdb/MAL-2025-46994.json"
      },
      "package": {
        "ecosystem": "npm",
        "name": "duckdb",
        "purl": "pkg:npm/duckdb"
      },
      "versions": [
        "1.3.3"
      ]
    }
  ],
  "credits": [
    {
      "contact": [
        "https://github.com/duckdb/duckdb-node"
      ],
      "name": "DuckDB Team",
      "type": "REPORTER"
    }
  ],
  "database_specific": {
    "iocs": {
      "domains": [
        "npmjs.help"
      ],
      "urls": [
        "https://npmjs.help"
      ]
    },
    "malicious-packages-origins": [
      {
        "id": "GHSA-m63q-rrxf-h93g",
        "import_time": "2025-09-11T00:34:35.475491373Z",
        "modified_time": "2025-09-09T14:39:32Z",
        "ranges": [
          {
            "events": [
              {
                "introduced": "0"
              }
            ],
            "type": "SEMVER"
          }
        ],
        "sha256": "2a0fabdf22d0170bff33887bfb283d3e5af1f7e0bd44137a573cb34f85666b19",
        "source": "ghsa-malware"
      }
    ]
  },
  "details": "The DuckDB Node.js package duckdb version 1.3.3 was compromised with malware through a sophisticated phishing attack targeting the DuckDB maintainers. An attacker created a pixel-perfect copy of the npmjs.com website at npmjs.help domain and tricked a maintainer into logging in and resetting 2FA. The attacker then used stolen credentials to publish malicious versions of DuckDB packages.\n\nThe malicious code was designed to interfere with cryptocurrency transactions, potentially allowing the attacker to steal or manipulate crypto wallet addresses and transactions. This represents a supply chain attack where legitimate packages were compromised to distribute malware.\n\nThe attack was discovered within 4 hours and the affected versions were immediately deprecated and deleted from npm. The maintainers re-released safe versions (1.3.4) to ensure users get clean packages.",
  "id": "MAL-2025-46994",
  "modified": "2025-09-09T10:30:00Z",
  "published": "2025-09-09T10:30:00Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://github.com/duckdb/duckdb-node/security/advisories/GHSA-w62p-hx95-gf2c"
    }
  ],
  "schema_version": "1.7.3",
  "summary": "Malicious code in duckdb (npm)"
}