{
  "affected": [
    {
      "database_specific": {
        "source": "https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2025-39677.json"
      },
      "ecosystem_specific": {
        "urgency": "not yet assigned"
      },
      "package": {
        "ecosystem": "Debian:14",
        "name": "linux",
        "purl": "pkg:deb/debian/linux?arch=source"
      },
      "ranges": [
        {
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "6.16.5-1"
            }
          ],
          "type": "ECOSYSTEM"
        }
      ],
      "versions": [
        "6.12.38-1",
        "6.12.41-1",
        "6.12.43-1",
        "6.12.43-1~bpo12+1",
        "6.12.48-1",
        "6.13.10-1~exp1",
        "6.13.11-1~exp1",
        "6.13.2-1~exp1",
        "6.13.3-1~exp1",
        "6.13.4-1~exp1",
        "6.13.5-1~exp1",
        "6.13.6-1~exp1",
        "6.13.7-1~exp1",
        "6.13.8-1~exp1",
        "6.13.9-1~exp1",
        "6.13~rc6-1~exp1",
        "6.13~rc7-1~exp1",
        "6.14.3-1~exp1",
        "6.14.5-1~exp1",
        "6.14.6-1~exp1",
        "6.15-1~exp1",
        "6.15.1-1~exp1",
        "6.15.2-1~exp1",
        "6.15.3-1~exp1",
        "6.15.4-1~exp1",
        "6.15.5-1~exp1",
        "6.15.6-1~exp1",
        "6.15~rc7-1~exp1",
        "6.16-1~exp1",
        "6.16.1-1~exp1",
        "6.16.3-1",
        "6.16.3-1~bpo13+1",
        "6.16~rc7-1~exp1"
      ]
    }
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:  net/sched: Fix backlog accounting in qdisc_dequeue_internal  This issue applies for the following qdiscs: hhf, fq, fq_codel, and fq_pie, and occurs in their change handlers when adjusting to the new limit. The problem is the following in the values passed to the subsequent qdisc_tree_reduce_backlog call given a tbf parent:     When the tbf parent runs out of tokens, skbs of these qdiscs will    be placed in gso_skb. Their peek handlers are qdisc_peek_dequeued,    which accounts for both qlen and backlog. However, in the case of    qdisc_dequeue_internal, ONLY qlen is accounted for when pulling    from gso_skb. This means that these qdiscs are missing a    qdisc_qstats_backlog_dec when dropping packets to satisfy the    new limit in their change handlers.     One can observe this issue with the following (with tc patched to    support a limit of 0):     export TARGET=fq    tc qdisc del dev lo root    tc qdisc add dev lo root handle 1: tbf rate 8bit burst 100b latency 1ms    tc qdisc replace dev lo handle 3: parent 1:1 $TARGET limit 1000    echo ''; echo 'add child'; tc -s -d qdisc show dev lo    ping -I lo -f -c2 -s32 -W0.001 127.0.0.1 2>&1 >/dev/null    echo ''; echo 'after ping'; tc -s -d qdisc show dev lo    tc qdisc change dev lo handle 3: parent 1:1 $TARGET limit 0    echo ''; echo 'after limit drop'; tc -s -d qdisc show dev lo    tc qdisc replace dev lo handle 2: parent 1:1 sfq    echo ''; echo 'post graft'; tc -s -d qdisc show dev lo     The second to last show command shows 0 packets but a positive    number (74) of backlog bytes. The problem becomes clearer in the    last show command, where qdisc_purge_queue triggers    qdisc_tree_reduce_backlog with the positive backlog and causes an    underflow in the tbf parent's backlog (4096 Mb instead of 0).  To fix this issue, the codepath for all clients of qdisc_dequeue_internal has been simplified: codel, pie, hhf, fq, fq_pie, and fq_codel. qdisc_dequeue_internal handles the backlog adjustments for all cases that do not directly use the dequeue handler.  The old fq_codel_change limit adjustment loop accumulated the arguments to the subsequent qdisc_tree_reduce_backlog call through the cstats field. However, this is confusing and error prone as fq_codel_dequeue could also potentially mutate this field (which qdisc_dequeue_internal calls in the non gso_skb case), so we have unified the code here with other qdiscs.",
  "id": "DEBIAN-CVE-2025-39677",
  "modified": "2025-09-24T00:58:56.538208Z",
  "published": "2025-09-05T18:15:44Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://security-tracker.debian.org/tracker/CVE-2025-39677"
    }
  ],
  "schema_version": "1.7.3"
}