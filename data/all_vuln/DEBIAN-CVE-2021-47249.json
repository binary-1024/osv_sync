{"schema_version":"1.7.3","id":"DEBIAN-CVE-2021-47249","published":"2024-05-21T15:15:13Z","modified":"2025-09-30T03:54:33Z","upstream":["CVE-2021-47249"],"details":"In the Linux kernel, the following vulnerability has been resolved:  net: rds: fix memory leak in rds_recvmsg  Syzbot reported memory leak in rds. The problem was in unputted refcount in case of error.  int rds_recvmsg(struct socket *sock, struct msghdr *msg, size_t size, \t\tint msg_flags) { ...  \tif (!rds_next_incoming(rs, &inc)) { \t\t... \t}  After this \"if\" inc refcount incremented and  \tif (rds_cmsg_recv(inc, msg, rs)) { \t\tret = -EFAULT; \t\tgoto out; \t} ... out: \treturn ret; }  in case of rds_cmsg_recv() fail the refcount won't be decremented. And it's easy to see from ftrace log, that rds_inc_addref() don't have rds_inc_put() pair in rds_recvmsg() after rds_cmsg_recv()   1)               |  rds_recvmsg() {  1)   3.721 us    |    rds_inc_addref();  1)   3.853 us    |    rds_message_inc_copy_to_user();  1) + 10.395 us   |    rds_cmsg_recv();  1) + 34.260 us   |  }","affected":[{"package":{"name":"linux","ecosystem":"Debian:11","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.46-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47249.json"}},{"package":{"name":"linux","ecosystem":"Debian:12","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.46-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47249.json"}},{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.46-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47249.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"5.10.46-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-47249.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2021-47249"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}]}