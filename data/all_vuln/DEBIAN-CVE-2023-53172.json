{"schema_version":"1.7.3","id":"DEBIAN-CVE-2023-53172","published":"2025-09-15T14:15:39Z","modified":"2025-09-25T03:45:12.765202Z","upstream":["CVE-2023-53172"],"details":"In the Linux kernel, the following vulnerability has been resolved:  fsverity: reject FS_IOC_ENABLE_VERITY on mode 3 fds  Commit 56124d6c87fd (\"fsverity: support enabling with tree block size < PAGE_SIZE\") changed FS_IOC_ENABLE_VERITY to use __kernel_read() to read the file's data, instead of direct pagecache accesses.  An unintended consequence of this is that the 'WARN_ON_ONCE(!(file->f_mode & FMODE_READ))' in __kernel_read() became reachable by fuzz tests.  This happens if FS_IOC_ENABLE_VERITY is called on a fd opened with access mode 3, which means \"ioctl access only\".  Arguably, FS_IOC_ENABLE_VERITY should work on ioctl-only fds.  But ioctl-only fds are a weird Linux extension that is rarely used and that few people even know about.  (The documentation for FS_IOC_ENABLE_VERITY even specifically says it requires O_RDONLY.)  It's probably not worthwhile to make the ioctl internally open a new fd just to handle this case.  Thus, just reject the ioctl on such fds for now.","affected":[{"package":{"name":"linux","ecosystem":"Debian:13","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.3.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53172.json"}},{"package":{"name":"linux","ecosystem":"Debian:14","purl":"pkg:deb/debian/linux?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"6.3.7-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2023-53172.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2023-53172"}]}