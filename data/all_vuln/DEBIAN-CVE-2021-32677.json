{"schema_version":"1.7.3","id":"DEBIAN-CVE-2021-32677","published":"2021-06-09T18:15:08Z","modified":"2025-09-30T05:15:02.751224Z","upstream":["CVE-2021-32677"],"details":"FastAPI is a web framework for building APIs with Python 3.6+ based on standard Python type hints. FastAPI versions lower than 0.65.2 that used cookies for authentication in path operations that received JSON payloads sent by browsers were vulnerable to a Cross-Site Request Forgery (CSRF) attack. In versions lower than 0.65.2, FastAPI would try to read the request payload as JSON even if the content-type header sent was not set to application/json or a compatible JSON media type (e.g. application/geo+json). A request with a content type of text/plain containing JSON data would be accepted and the JSON data would be extracted. Requests with content type text/plain are exempt from CORS preflights, for being considered Simple requests. The browser will execute them right away including cookies, and the text content could be a JSON string that would be parsed and accepted by the FastAPI application. This is fixed in FastAPI 0.65.2. The request data is now parsed as JSON only if the content-type header is application/json or another JSON compatible media type like application/geo+json. It's best to upgrade to the latest FastAPI, but if updating is not possible then a middleware or a dependency that checks the content-type header and aborts the request if it is not application/json or another JSON compatible content type can act as a mitigating workaround.","affected":[{"package":{"name":"fastapi","ecosystem":"Debian:11","purl":"pkg:deb/debian/fastapi?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"}]}],"versions":["0.100.0-1","0.100.0-2","0.101.0-1","0.101.0-2","0.101.0-3","0.110.0-1","0.115.11-1","0.115.11-2","0.115.11-3","0.115.11-4","0.115.11-5","0.115.5-1","0.115.5-2","0.115.5-3","0.63.0-2","0.70.0-1","0.70.0-2","0.70.1-1","0.73.0-1","0.74.1-1","0.85.0-1","0.85.0-2","0.88.0-1","0.89.1-1","0.91.0-1","0.92.0-1"],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-32677.json"}},{"package":{"name":"fastapi","ecosystem":"Debian:12","purl":"pkg:deb/debian/fastapi?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"0.70.0-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-32677.json"}},{"package":{"name":"fastapi","ecosystem":"Debian:13","purl":"pkg:deb/debian/fastapi?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"0.70.0-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-32677.json"}},{"package":{"name":"fastapi","ecosystem":"Debian:14","purl":"pkg:deb/debian/fastapi?arch=source"},"ranges":[{"type":"ECOSYSTEM","events":[{"introduced":"0"},{"fixed":"0.70.0-1"}]}],"ecosystem_specific":{"urgency":"not yet assigned"},"database_specific":{"source":"https://storage.googleapis.com/debian-osv/debian-cve-osv/DEBIAN-CVE-2021-32677.json"}}],"references":[{"type":"ADVISORY","url":"https://security-tracker.debian.org/tracker/CVE-2021-32677"}],"severity":[{"type":"CVSS_V3","score":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"}]}